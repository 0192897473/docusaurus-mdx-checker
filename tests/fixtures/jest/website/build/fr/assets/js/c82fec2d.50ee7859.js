"use strict";(self.webpackChunkjest_website=self.webpackChunkjest_website||[]).push([[1508],{438:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>u,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var n=t(4246),r=t(1670);const o={title:"Jest 26\xa0: Tic Tac",author:"Christoph Nakazawa",authorURL:"http://twitter.com/cpojer",authorFBID:0x5af311d9a1c8},i=void 0,a={permalink:"/fr/blog/2020/05/05/jest-26",editUrl:"https://github.com/jestjs/jest/tree/main/website/blog/2020-05-05-jest-26.md",source:"@site/i18n/fr/docusaurus-plugin-content-blog/2020-05-05-jest-26.md",title:"Jest 26\xa0: Tic Tac",description:"Lorsque nous avons commenc\xe9 \xe0 reconstruire Jest il y a cinq ans, notre objectif \xe9tait de fournir un ex\xe9cuteur de tests sans configuration, accessible aux d\xe9butants, extensible pour presque tous les cas d'utilisation de tests et \xe9volutif pour les grands projets. L'une des versions essentielles a \xe9t\xe9 Jest 15, qui a tout regroup\xe9 et fourni de bonnes valeurs par d\xe9faut permettant aux gens d'ex\xe9cuter Jest souvent sans aucune configuration. Cependant, cette approche a un gros inconv\xe9nient car Jest installe beaucoup de d\xe9pendances dans vos projets dont vous n'avez peut-\xeatre pas besoin.",date:"2020-05-05T00:00:00.000Z",formattedDate:"5 mai 2020",tags:[],readingTime:6.67,hasTruncateMarker:!0,authors:[{name:"Christoph Nakazawa",url:"http://twitter.com/cpojer"}],frontMatter:{title:"Jest 26\xa0: Tic Tac",author:"Christoph Nakazawa",authorURL:"http://twitter.com/cpojer",authorFBID:0x5af311d9a1c8},unlisted:!1,prevItem:{title:"Mise \xe0 niveau du site web de Jest",permalink:"/fr/blog/2021/03/09/jest-website-upgrade"},nextItem:{title:"Jest 25\xa0: \ud83d\ude80 pose des fondations pour le futur",permalink:"/fr/blog/2020/01/21/jest-25"}},u={authorsImageUrls:[void 0]},l=[{value:"Nouveaux temporisateurs fictifs",id:"nouveaux-temporisateurs-fictifs",level:2},{value:"Une nouvelle fa\xe7on de consommer Jest - <code>@jest/globals</code>",id:"une-nouvelle-fa\xe7on-de-consommer-jest---jestglobals",level:2},{value:"Support natif de l&#39;ESM",id:"support-natif-de-lesm",level:2},{value:"Autres changements de rupture dans Jest 26",id:"autres-changements-de-rupture-dans-jest-26",level:2},{value:"Prenez soin de vous",id:"prenez-soin-de-vous",level:2}];function c(e){const s=Object.assign({p:"p",a:"a",strong:"strong",ul:"ul",li:"li",code:"code",blockquote:"blockquote",pre:"pre",h2:"h2",em:"em"},(0,r.ah)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.p,{children:["Lorsque nous avons commenc\xe9 \xe0 reconstruire Jest il y a cinq ans, notre objectif \xe9tait de fournir un ex\xe9cuteur de tests sans configuration, accessible aux d\xe9butants, extensible pour presque tous les cas d'utilisation de tests et \xe9volutif pour les grands projets. L'une des versions essentielles a \xe9t\xe9 ",(0,n.jsx)(s.a,{href:"/blog/2016/09/01/jest-15",children:"Jest 15"}),", qui a tout regroup\xe9 et fourni de bonnes valeurs par d\xe9faut permettant aux gens d'ex\xe9cuter Jest souvent sans aucune configuration. Cependant, cette approche a un gros inconv\xe9nient car Jest installe beaucoup de d\xe9pendances dans vos projets dont vous n'avez peut-\xeatre pas besoin."]}),"\n",(0,n.jsxs)(s.p,{children:["Nous commen\xe7ons \xe0 rem\xe9dier \xe0 cette lacune et nous nous effor\xe7ons de r\xe9duire la taille de l'installation de Jest tout en le gardant accessible et extensible. Nous avons apport\xe9 les ",(0,n.jsx)(s.strong,{children:"changements de rupture"})," suivants dans Jest 26 :"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"[expect, jest-mock, pretty-format]"})," Remove ",(0,n.jsx)(s.code,{children:"ES5"})," build files with a new minimum of support of ES2015 (Node 8) which were only used for browser builds (",(0,n.jsx)(s.a,{href:"https://github.com/jestjs/jest/pull/9945",children:"#9945"}),")"]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Migration"})," : Avec ce changement, nous poussons la responsabilit\xe9 vers les utilisateurs pour regrouper les paquets affect\xe9s, plut\xf4t que Jest les fournisse directement, puisqu'ils connaissent mieux leurs environnements cibles. Si vous voulez le r\xe9cup\xe9rer, nous sommes pr\xeats \xe0 les exp\xe9dier s\xe9par\xe9ment. Les PRs sont les bienvenus\xa0!"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"[jest-config, jest-resolve]"})," Remove support for ",(0,n.jsx)(s.code,{children:"browser"})," field (",(0,n.jsx)(s.a,{href:"https://github.com/jestjs/jest/pull/9943",children:"#9943"}),")"]}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Migration"}),"\xa0: Installez le module ",(0,n.jsx)(s.code,{children:"browser-resolve"})," et utilisez la configuration suivante\xa0:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-json",children:'  {\n    "jest": {\n      "resolver": "<rootDir>/resolver.js"\n    }\n  }\n'})}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:"// resolver.js\nconst browserResolve = require('browser-resolve');\n\nmodule.exports = browserResolve.sync;\n"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["TypeScript definitions requires a minimum of TypeScript v3.8 (",(0,n.jsx)(s.a,{href:"https://github.com/jestjs/jest/pull/9823",children:"#9823"}),")"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"Avec les changements ci-dessus, Jest 26 est maintenant 4 MiB plus petit que Jest 25.5.4 (53 \u2192 49 MiB). N'oubliez pas que de nombreuses d\xe9pendances, comme Babel, font probablement d\xe9j\xe0 partie de votre projet. La taille de Jest a \xe9t\xe9 r\xe9duite de 1,2 MiB (4,3 -> 3,1 MiB)."}),"\n",(0,n.jsxs)(s.p,{children:["Bien qu'il s'agisse d'un bon d\xe9but, cela ne suffit pas \xe0 all\xe9ger significativement Jest. Nous pr\xe9voyons de r\xe9duire progressivement la taille de Jest et de son arbre de d\xe9pendances jusqu'\xe0 70%. La plupart des changements visant \xe0 r\xe9duire la configuration par d\xe9faut de Jest seront de petits changements de rupture et nous voulons amener la communaut\xe9 avec nous autant que possible. Par cons\xe9quent, nous apporterons les changements suivants dans Jest 27 et Jest 28 en utilisant un ",(0,n.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/Tick%E2%80%93tock_model",children:'processus de publication "Tick-Tock"'})," :"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:['Jest 27 sera livr\xe9 avec un nouveau runner de test "',(0,n.jsx)(s.code,{children:"jest-circus"}),"\" et l'environnement Node.js par d\xe9faut. ",(0,n.jsx)(s.code,{children:"jest-jasmine2"})," et ",(0,n.jsx)(s.code,{children:"jest-environment-jsdom"})," seront toujours fournis afin que les utilisateurs puissent continuer \xe0 les utiliser en changeant une ligne chacun dans la configuration."]}),"\n",(0,n.jsxs)(s.li,{children:["Jest 28 supprimera ",(0,n.jsx)(s.code,{children:"jest-jasmine2"})," et ",(0,n.jsx)(s.code,{children:"jest-environment-jsdom"})," de la distribution par d\xe9faut de Jest. Les paquets seront toujours activement maintenus dans le cadre du projet Jest et seront publi\xe9s s\xe9par\xe9ment. Les utilisateurs devront installer ces paquets pour les utiliser."]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"Lors de la mise \xe0 jour vers ces versions majeures, Jest vous guidera \xe0 travers les changements n\xe9cessaires. Si vous souhaitez prendre de l'avance et migrer vers les nouveaux param\xe8tres par d\xe9faut d\xe8s maintenant, et que votre projet ne n\xe9cessite pas un environnement DOM, vous pouvez passer \xe0 Jest 26 et ajouter les options de configuration suivantes\xa0:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-json",children:'{\n  "jest": {\n    "testEnvironment": "node",\n    "testRunner": "jest-circus/runner"\n  }\n}\n'})}),"\n",(0,n.jsxs)(s.p,{children:["Jest continuera \xe0 \xeatre livr\xe9 avec ",(0,n.jsx)(s.code,{children:"babel-jest"})," activ\xe9 par d\xe9faut. Il alimente actuellement quelques fonctionnalit\xe9s de Jest au-del\xe0 de la compilation de la syntaxe JavaScript moderne vers quelque chose de compris par les versions actuelles de Node.js et des navigateurs : Il permet \xe9galement la couverture du code de Jest et l'adaptation des modules ES. Jest est actuellement livr\xe9 avec un support exp\xe9rimental pour ",(0,n.jsx)(s.a,{href:"/blog/2020/01/21/jest-25#v8-code-coverage",children:"la couverture V8"})," et un support natif pour les modules ES (plus sur ce sujet ci-dessous\xa0!). Il n'est pas possible de simuler des modules ES statiques conform\xe9ment aux sp\xe9cifications sans transformer le code au pr\xe9alable. Nous encouragerons donc les patterns qui fonctionnent sans la transformation pour laquelle nous utilisons Babel aujourd'hui. Une fois que la couverture V8 et le support ESM natif se seront stabilis\xe9s dans Jest, nous pourrons \xe9galement supprimer ",(0,n.jsx)(s.code,{children:"babel-jest"})," par d\xe9faut mais nous continuerons \xe0 le maintenir."]}),"\n",(0,n.jsx)(s.h2,{id:"nouveaux-temporisateurs-fictifs",children:"Nouveaux temporisateurs fictifs"}),"\n",(0,n.jsxs)(s.p,{children:["Avec Jest 26, nous livrons une nouvelle impl\xe9mentation des temporisateurs fictifs bas\xe9e sur ",(0,n.jsx)(s.code,{children:"@sinonjs/fake-timers"}),". Nous voulions faire cela depuis des ann\xe9es et nous sommes heureux que cela ait finalement progress\xe9 suffisamment pour supporter tous les cas d'utilisation des temporisateurs fictifs de Jest."]}),"\n",(0,n.jsxs)(s.p,{children:["La nouvelle impl\xe9mentation est accompagn\xe9e de fonctionnalit\xe9s suppl\xe9mentaires telles que la simulation de ",(0,n.jsx)(s.code,{children:"Date"}),", ",(0,n.jsx)(s.code,{children:"queueMicrotask"})," et plus encore, consultez ",(0,n.jsx)(s.a,{href:"https://github.com/sinonjs/fake-timers/blob/master/README.md",children:"ce README"}),". Il fonctionne de mani\xe8re transparente en utilisant les API de temporisateur existants comme ",(0,n.jsx)(s.code,{children:"jest.runAllTimers()"})," - consultez la documentation ",(0,n.jsx)(s.a,{href:"/docs/timer-mocks",children:"sur notre site web"}),"."]}),"\n",(0,n.jsxs)(s.p,{children:["Nous sommes convaincus que cette impl\xe9mentation est pr\xeate pour le grand public, mais nous ne voulons pas obliger les gens \xe0 r\xe9\xe9crire leurs tests s'ils d\xe9pendent de diff\xe9rences subtiles entre l'ancienne et la nouvelle impl\xe9mentation. Dans Jest 26, cette nouvelle impl\xe9mentation restera ",(0,n.jsx)(s.em,{children:"opt-in"})," et peut \xeatre activ\xe9e en appelant ",(0,n.jsx)(s.code,{children:"jest.useFakeTimers('modern')"})," ou en passant ",(0,n.jsx)(s.code,{children:"modern"})," \xe0 l'option ",(0,n.jsx)(s.code,{children:"timers"})," dans votre configuration si vous aviez opt\xe9 pour tous les tests en temporisateurs fictifs pr\xe9c\xe9demment."]}),"\n",(0,n.jsxs)(s.p,{children:['Dans Jest 27, nous \xe9changerons la valeur par d\xe9faut contre la nouvelle impl\xe9mentation "modern" mais nous continuerons \xe0 soutenir et \xe0 maintenir l\'impl\xe9mentation h\xe9rit\xe9e qui peut \xeatre utilis\xe9e en appelant ',(0,n.jsx)(s.code,{children:"jest.useFakeTimers('legacy')"}),". Si vous n'\xeates pas s\xfbr de pouvoir mettre \xe0 jour tous vos tests d'ici la sortie de Jest 27, vous pouvez ajouter cette option \xe0 vos tests maintenant pour conserver l'ancien comportement."]}),"\n",(0,n.jsxs)(s.p,{children:["Nous tenons \xe0 remercier ",(0,n.jsx)(s.a,{href:"https://github.com/fatso83",children:"Carl-Erik Kopseng"}),", ",(0,n.jsx)(s.a,{href:"https://github.com/benjamingr",children:"Benjamin Gruenbaum"})," et les autres mainteneurs de ",(0,n.jsx)(s.code,{children:"@sinonjs/fake-timers"})," pour leur aide et leur patience lorsqu'ils ont travaill\xe9 avec nous pour que cela se r\xe9alise\xa0! ",(0,n.jsx)(s.em,{children:"Int\xe9ressant"}),"."]}),"\n",(0,n.jsxs)(s.h2,{id:"une-nouvelle-fa\xe7on-de-consommer-jest---jestglobals",children:["Une nouvelle fa\xe7on de consommer Jest - ",(0,n.jsx)(s.code,{children:"@jest/globals"})]}),"\n",(0,n.jsxs)(s.p,{children:["Jest s'est appuy\xe9 sur les globaux populaires du framework de test Jasmine et d'autres tels que ",(0,n.jsx)(s.code,{children:"describe"}),", ",(0,n.jsx)(s.code,{children:"it"}),", ",(0,n.jsx)(s.code,{children:"test"})," et ",(0,n.jsx)(s.code,{children:"expect"}),". Bien que ce mod\xe8le soit largement utilis\xe9, de nombreuses personnes ont exprim\xe9 leur pr\xe9f\xe9rence pour l'importation de fonctions li\xe9es aux tests. Pour prendre en charge ce cas d'utilisation, nous avons ajout\xe9 un nouveau package ",(0,n.jsx)(s.code,{children:"@jest/globals"})," qui peut \xeatre utilis\xe9 pour importer des fonctions de test\xa0: ",(0,n.jsx)(s.code,{children:"import {expect, jest, test} from '@jest/globals';"}),"."]}),"\n",(0,n.jsx)(s.p,{children:"Mises en garde\xa0:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Actuellement, les globales existent encore dans l'environnement, mais nous allons introduire un mode pour d\xe9sactiver les globales \xe0 l'avenir. De m\xeame, vous ne pouvez pas utiliser ",(0,n.jsx)(s.code,{children:"const jest = require('@jest/globals')"})," car vous obtiendrez des erreurs de d\xe9claration car la variable ",(0,n.jsx)(s.code,{children:"jest"})," est toujours une globale pour le moment."]}),"\n",(0,n.jsx)(s.li,{children:"Il n'existe actuellement aucun moyen d'ajouter des comparateurs personnalis\xe9s aux d\xe9finitions TypeScript lors de l'utilisation de globaux comme celui-ci."}),"\n",(0,n.jsx)(s.li,{children:"Bien que cela permette d'ex\xe9cuter des tests sans globales, cela ne permet pas d'ex\xe9cuter des tests sans le gestionnaire de tests de Jest pour le moment."}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"support-natif-de-lesm",children:"Support natif de l'ESM"}),"\n",(0,n.jsxs)(s.p,{children:["Comme mentionn\xe9 dans l'",(0,n.jsx)(s.a,{href:"/blog/2020/01/21/jest-25#ecmascript-modules-support",children:"article du blog Jest 25"})," nous avons travaill\xe9 sur le support natif des modules ECMAScript. Il n'est pas encore stable, mais il est pr\xeat \xe0 \xeatre test\xe9. Nous serions ravis de recevoir vos commentaires et vos rapports de bogue ! For an overview of the current state you can check out ",(0,n.jsx)(s.a,{href:"https://github.com/jestjs/jest/issues/9430",children:"this issue"}),", or browse all issues with that label ",(0,n.jsx)(s.a,{href:"https://github.com/jestjs/jest/labels/ES%20Modules",children:"ES Modules"}),"."]}),"\n",(0,n.jsx)(s.h2,{id:"autres-changements-de-rupture-dans-jest-26",children:"Autres changements de rupture dans Jest 26"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Dropped support for Node 8 (",(0,n.jsx)(s.a,{href:"https://github.com/jestjs/jest/pull/9423",children:"#9423"}),")"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"[jest-environment-jsdom]"})," Upgrade ",(0,n.jsx)(s.code,{children:"jsdom"})," to v16 (",(0,n.jsx)(s.a,{href:"https://github.com/jestjs/jest/pull/9606",children:"#9606"}),")"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"[jest-runtime]"})," Remove long-deprecated ",(0,n.jsx)(s.code,{children:"require.requireActual"})," and ",(0,n.jsx)(s.code,{children:"require.requireMock"})," methods (",(0,n.jsx)(s.a,{href:"https://github.com/jestjs/jest/pull/9854",children:"#9854"}),")"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"[jest-haste-map]"})," Removed ",(0,n.jsx)(s.code,{children:"providesModuleNodeModules"})," (",(0,n.jsx)(s.a,{href:"https://github.com/jestjs/jest/pull/8535",children:"#8535"}),")"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"[jest-circus]"})," Fail tests if a test takes a done callback and have return values (",(0,n.jsx)(s.a,{href:"https://github.com/jestjs/jest/pull/9129",children:"#9129"}),")"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"[jest-circus]"})," Throw a proper error if a test / hooks is defined asynchronously (",(0,n.jsx)(s.a,{href:"https://github.com/jestjs/jest/pull/8096",children:"#8096"}),")"]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"prenez-soin-de-vous",children:"Prenez soin de vous"}),"\n",(0,n.jsxs)(s.p,{children:["Nous vivons tous actuellement une p\xe9riode d'incertitude sans pr\xe9c\xe9dent. Si vous avez des difficult\xe9s financi\xe8res, nous aimerions utiliser ",(0,n.jsx)(s.a,{href:"https://opencollective.com/jest",children:"le fond collectif ouvert de Jest"})," pour aider les nouveaux et anciens contributeurs. We place ",(0,n.jsx)(s.a,{href:"https://github.com/jestjs/jest/issues?q=is%3Aissue+is%3Aopen+bounty+label%3A%22Has+Bounty%22",children:"bounties on some issues"})," and are open to offering a bounty on any of our current open issues - you can mention that an issue should have a bounty in the issue or contact ",(0,n.jsx)(s.a,{href:"https://twitter.com/cpojer",children:"@cpojer via private message on Twitter"}),"."]}),"\n",(0,n.jsx)(s.p,{children:"Soyez prudent."})]})}const d=function(e={}){const{wrapper:s}=Object.assign({},(0,r.ah)(),e.components);return s?(0,n.jsx)(s,Object.assign({},e,{children:(0,n.jsx)(c,e)})):c(e)}},1670:(e,s,t)=>{t.d(s,{Zo:()=>a,ah:()=>o});var n=t(7378);const r=n.createContext({});function o(e){const s=n.useContext(r);return n.useMemo((()=>"function"==typeof e?e(s):{...s,...e}),[s,e])}const i={};function a({components:e,children:s,disableParentContext:t}){let a;return a=t?"function"==typeof e?e({}):e||i:o(e),n.createElement(r.Provider,{value:a},s)}}}]);