"use strict";(self.webpackChunkjest_website=self.webpackChunkjest_website||[]).push([[3394],{3285:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>d,default:()=>j,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var o=t(4246),n=t(1670),r=t(4191);const i={id:"upgrading-to-jest29",title:"De la v28 \xe0 la v29"},d=void 0,c={unversionedId:"upgrading-to-jest29",id:"version-29.4/upgrading-to-jest29",title:"De la v28 \xe0 la v29",description:"Mise \xe0 jour de la v28 \xe0 la v29 de Jest\xa0? Ce guide a pour but de vous aider \xe0 refactoriser votre configuration et vos tests.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-29.4/UpgradingToJest29.md",sourceDirName:".",slug:"/upgrading-to-jest29",permalink:"/fr/docs/29.4/upgrading-to-jest29",draft:!1,unlisted:!1,editUrl:"https://crowdin.com/project/jest-v2/fr",tags:[],version:"29.4",frontMatter:{id:"upgrading-to-jest29",title:"De la v28 \xe0 la v29"},sidebar:"docs",previous:{title:"Test des frameworks web",permalink:"/fr/docs/29.4/testing-frameworks"}},a={},l=[{value:"Compatibilit\xe9",id:"compatibilit\xe9",level:2},{value:"Format du snapshot",id:"format-du-snapshot",level:2},{value:"Mise \xe0 jour de JSDOM",id:"mise-\xe0-jour-de-jsdom",level:2},{value:"<code>pretty-format</code>",id:"pretty-format",level:2},{value:"<code>jest-mock</code>",id:"jest-mock",level:3},{value:"TypeScript",id:"typescript",level:2},{value:"<code>jest.mocked()</code>",id:"jestmocked",level:3}];function p(e){const s=Object.assign({p:"p",admonition:"admonition",a:"a",h2:"h2",code:"code",pre:"pre",h3:"h3"},(0,n.ah)(),e.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.p,{children:"Mise \xe0 jour de la v28 \xe0 la v29 de Jest\xa0? Ce guide a pour but de vous aider \xe0 refactoriser votre configuration et vos tests."}),"\n",(0,o.jsx)(s.admonition,{type:"info",children:(0,o.jsxs)(s.p,{children:["See ",(0,o.jsx)(s.a,{href:"https://github.com/jestjs/jest/blob/main/CHANGELOG.md#2900",children:"changelog"})," for the full list of changes."]})}),"\n",(0,o.jsx)(s.admonition,{title:"remarque",type:"note",children:(0,o.jsxs)(s.p,{children:["Mettre \xe0 jour depuis une ancienne version\xa0? Vous pouvez voir le guide de mise \xe0 jour de la v27 \xe0 la v28 ",(0,o.jsx)(s.a,{href:"/docs/28.x/upgrading-to-jest28",children:"ici"}),"."]})}),"\n",(0,o.jsx)(s.h2,{id:"compatibilit\xe9",children:"Compatibilit\xe9"}),"\n",(0,o.jsx)(s.p,{children:"Les versions de Node support\xe9es sont 14.15, 16.10, 18.0 et sup\xe9rieures."}),"\n",(0,o.jsx)(s.h2,{id:"format-du-snapshot",children:"Format du snapshot"}),"\n",(0,o.jsxs)(s.p,{children:["Comme annonc\xe9 dans ",(0,o.jsx)(s.a,{href:"/blog/2022/04/25/jest-28#future",children:"l'article du blog de Jest 28"}),", Jest 29 a chang\xe9 le formatage par d\xe9faut des snapshots en ",(0,o.jsx)(s.code,{children:"{escapeString: false, printBasicPrototype: false}"}),"."]}),"\n",(0,o.jsxs)(s.p,{children:["Si vous voulez conserver l'ancien comportement, vous pouvez d\xe9finir la propri\xe9t\xe9 ",(0,o.jsx)(s.code,{children:"snapshotFormat"})," \xe0\xa0:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-diff",children:"+ snapshotFormat: {\n+   escapeString: true,\n+   printBasicPrototype: true\n+ }\n"})}),"\n",(0,o.jsx)(s.h2,{id:"mise-\xe0-jour-de-jsdom",children:"Mise \xe0 jour de JSDOM"}),"\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.code,{children:"jest-environment-jsdom"})," has upgraded ",(0,o.jsx)(s.code,{children:"jsdom"})," from v19 to v20."]}),"\n",(0,o.jsx)(s.admonition,{type:"info",children:(0,o.jsxs)(s.p,{children:["If you use ",(0,o.jsx)(s.code,{children:"jest-environment-jsdom"}),", the minimum TypeScript version is set to ",(0,o.jsx)(s.code,{children:"4.5"}),"."]})}),"\n",(0,o.jsxs)(s.p,{children:["Notamment, ",(0,o.jsx)(s.code,{children:"jsdom@20"})," inclut le support de ",(0,o.jsx)(s.code,{children:"crypto.getRandomValues()"}),", ce qui signifie que des paquets comme ",(0,o.jsx)(s.code,{children:"uuid"})," et ",(0,o.jsx)(s.code,{children:"nanoid"}),", qui ne fonctionne pas correctement dans Jest@28, peuvent fonctionner sans polyfills suppl\xe9mentaires."]}),"\n",(0,o.jsx)(s.h2,{id:"pretty-format",children:(0,o.jsx)(s.code,{children:"pretty-format"})}),"\n",(0,o.jsxs)(s.p,{children:["Le plugin ",(0,o.jsx)(s.code,{children:"ConvertAnsi"})," est supprim\xe9 du paquet ",(0,o.jsx)(s.code,{children:"pretty-format"})," en faveur de ",(0,o.jsx)(s.a,{href:"https://github.com/mrazauskas/jest-serializer-ansi-escapes",children:(0,o.jsx)(s.code,{children:"jest-serializer-ansi-escapes"})}),"."]}),"\n",(0,o.jsx)(s.h3,{id:"jest-mock",children:(0,o.jsx)(s.code,{children:"jest-mock"})}),"\n",(0,o.jsxs)(s.p,{children:["Exports of ",(0,o.jsx)(s.code,{children:"Mocked*"})," utility types from ",(0,o.jsx)(s.code,{children:"jest-mock"})," package have changed. ",(0,o.jsx)(s.code,{children:"MaybeMockedDeep"})," and ",(0,o.jsx)(s.code,{children:"MaybeMocked"})," now are exported as ",(0,o.jsx)(s.code,{children:"Mocked"})," and ",(0,o.jsx)(s.code,{children:"MockedShallow"})," respectively; only deep mocked variants of ",(0,o.jsx)(s.code,{children:"MockedClass"}),", ",(0,o.jsx)(s.code,{children:"MockedFunction"})," and ",(0,o.jsx)(s.code,{children:"MockedObject"})," are exposed."]}),"\n",(0,o.jsx)(s.h2,{id:"typescript",children:"TypeScript"}),"\n","\n","\n",(0,o.jsx)(r.ZP,{}),"\n",(0,o.jsx)(s.h3,{id:"jestmocked",children:(0,o.jsx)(s.code,{children:"jest.mocked()"})}),"\n",(0,o.jsxs)(s.p,{children:["The ",(0,o.jsx)(s.a,{href:"MockFunctionAPI.md/#jestmockedsource-options",children:(0,o.jsx)(s.code,{children:"jest.mocked()"})})," helper method now wraps types of deep members of passed object by default. If you have used the method with ",(0,o.jsx)(s.code,{children:"true"})," as the second argument, remove it to avoid type errors:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-diff",children:"- const mockedObject = jest.mocked(someObject, true);\n+ const mockedObject = jest.mocked(someObject);\n"})}),"\n",(0,o.jsxs)(s.p,{children:["To have the old shallow mocked behavior, pass ",(0,o.jsx)(s.code,{children:"{shallow: true}"})," as the second argument:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-diff",children:"- const mockedObject = jest.mocked(someObject);\n+ const mockedObject = jest.mocked(someObject, {shallow: true});\n"})})]})}const j=function(e={}){const{wrapper:s}=Object.assign({},(0,n.ah)(),e.components);return s?(0,o.jsx)(s,Object.assign({},e,{children:(0,o.jsx)(p,e)})):p(e)}},4191:(e,s,t)=>{t.d(s,{ZP:()=>i});var o=t(4246),n=t(1670);function r(e){const s=Object.assign({admonition:"admonition",p:"p",pre:"pre",code:"code",a:"a"},(0,n.ah)(),e.components);return(0,o.jsxs)(s.admonition,{type:"info",children:[(0,o.jsx)(s.p,{children:"Les exemples TypeScript de cette page ne fonctionneront comme document\xe9 que si vous importez explicitement les API Jest\xa0:"}),(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-ts",children:"import {expect, jest, test} from '@jest/globals';\n"})}),(0,o.jsxs)(s.p,{children:["Veuillez consulter le guide ",(0,o.jsx)(s.a,{href:"/fr/docs/29.4/getting-started#using-typescript",children:"Premiers pas"})," pour plus de d\xe9tails sur la fa\xe7on de configurer Jest avec TypeScript."]})]})}const i=function(e={}){const{wrapper:s}=Object.assign({},(0,n.ah)(),e.components);return s?(0,o.jsx)(s,Object.assign({},e,{children:(0,o.jsx)(r,e)})):r(e)}},1670:(e,s,t)=>{t.d(s,{Zo:()=>d,ah:()=>r});var o=t(7378);const n=o.createContext({});function r(e){const s=o.useContext(n);return o.useMemo((()=>"function"==typeof e?e(s):{...s,...e}),[s,e])}const i={};function d({components:e,children:s,disableParentContext:t}){let d;return d=t?"function"==typeof e?e({}):e||i:r(e),o.createElement(n.Provider,{value:d},s)}}}]);