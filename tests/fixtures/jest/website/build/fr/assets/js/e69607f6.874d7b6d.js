"use strict";(self.webpackChunkjest_website=self.webpackChunkjest_website||[]).push([[94],{2599:(e,s,n)=>{n.d(s,{Z:()=>a});n(7378);var t=n(7140);const r={tabItem:"tabItem_wHwb"};var o=n(4246);function a(e){let{children:s,hidden:n,className:a}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,t.Z)(r.tabItem,a),hidden:n,children:s})}},8447:(e,s,n)=>{n.d(s,{Z:()=>y});var t=n(7378),r=n(7140),o=n(9169),a=n(3620),i=n(9749),l=n(8981),u=n(56),c=n(8796);function d(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:s}=e;return!!s&&"object"==typeof s&&"value"in s}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:s,children:n}=e;return(0,t.useMemo)((()=>{const e=s??function(e){return d(e).map((e=>{let{props:{value:s,label:n,attributes:t,default:r}}=e;return{value:s,label:n,attributes:t,default:r}}))}(n);return function(e){const s=(0,u.l)(e,((e,s)=>e.value===s.value));if(s.length>0)throw new Error(`Docusaurus error: Duplicate values "${s.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[s,n])}function h(e){let{value:s,tabValues:n}=e;return n.some((e=>e.value===s))}function m(e){let{queryString:s=!1,groupId:n}=e;const r=(0,a.k6)(),o=function(e){let{queryString:s=!1,groupId:n}=e;if("string"==typeof s)return s;if(!1===s)return null;if(!0===s&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:s,groupId:n});return[(0,l._X)(o),(0,t.useCallback)((e=>{if(!o)return;const s=new URLSearchParams(r.location.search);s.set(o,e),r.replace({...r.location,search:s.toString()})}),[o,r])]}function g(e){const{defaultValue:s,queryString:n=!1,groupId:r}=e,o=p(e),[a,l]=(0,t.useState)((()=>function(e){let{defaultValue:s,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(s){if(!h({value:s,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${s}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return s}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:s,tabValues:o}))),[u,d]=m({queryString:n,groupId:r}),[g,b]=function(e){let{groupId:s}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(s),[r,o]=(0,c.Nk)(n);return[r,(0,t.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:r}),j=(()=>{const e=u??g;return h({value:e,tabValues:o})?e:null})();(0,i.Z)((()=>{j&&l(j)}),[j]);return{selectedValue:a,selectValue:(0,t.useCallback)((e=>{if(!h({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),b(e)}),[d,b,o]),tabValues:o}}var b=n(362);const j={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var x=n(4246);function v(e){let{className:s,block:n,selectedValue:t,selectValue:a,tabValues:i}=e;const l=[],{blockElementScrollPositionUntilNextRender:u}=(0,o.o5)(),c=e=>{const s=e.currentTarget,n=l.indexOf(s),r=i[n].value;r!==t&&(u(s),a(r))},d=e=>{let s=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;s=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;s=l[n]??l[l.length-1];break}}s?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":n},s),children:i.map((e=>{let{value:s,label:n,attributes:o}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:t===s?0:-1,"aria-selected":t===s,ref:e=>l.push(e),onKeyDown:d,onClick:c,...o,className:(0,r.Z)("tabs__item",j.tabItem,o?.className,{"tabs__item--active":t===s}),children:n??s},s)}))})}function f(e){let{lazy:s,children:n,selectedValue:r}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(s){const e=o.find((e=>e.props.value===r));return e?(0,t.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:o.map(((e,s)=>(0,t.cloneElement)(e,{key:s,hidden:e.props.value!==r})))})}function w(e){const s=g(e);return(0,x.jsxs)("div",{className:(0,r.Z)("tabs-container",j.tabList),children:[(0,x.jsx)(v,{...e,...s}),(0,x.jsx)(f,{...e,...s})]})}function y(e){const s=(0,b.Z)();return(0,x.jsx)(w,{...e,children:d(e.children)},String(s))}},2765:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>u,toc:()=>d});var t=n(4246),r=n(1670),o=n(8447),a=n(2599);const i={id:"troubleshooting",title:"D\xe9pannage"},l=void 0,u={unversionedId:"troubleshooting",id:"troubleshooting",title:"D\xe9pannage",description:"Oh oh, quelque chose s'est mal pass\xe9\xa0? Utilisez ce guide pour r\xe9soudre les probl\xe8mes avec Jest.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/Troubleshooting.md",sourceDirName:".",slug:"/troubleshooting",permalink:"/fr/docs/next/troubleshooting",draft:!1,unlisted:!1,editUrl:"https://crowdin.com/project/jest-v2/fr",tags:[],version:"current",frontMatter:{id:"troubleshooting",title:"D\xe9pannage"},sidebar:"docs",previous:{title:"Changer pour Jest",permalink:"/fr/docs/next/migration-guide"},next:{title:"Architecture",permalink:"/fr/docs/next/architecture"}},c={},d=[{value:"Les tests \xe9chouent et vous ne savez pourquoi",id:"les-tests-\xe9chouent-et-vous-ne-savez-pourquoi",level:2},{value:"D\xe9bogage dans VS Code",id:"d\xe9bogage-dans-vs-code",level:2},{value:"D\xe9bogage dans WebStorm",id:"d\xe9bogage-dans-webstorm",level:2},{value:"Probl\xe8mes de Cache",id:"probl\xe8mes-de-cache",level:2},{value:"Promesses non r\xe9solues",id:"promesses-non-r\xe9solues",level:2},{value:"Probl\xe8mes de Watchman",id:"probl\xe8mes-de-watchman",level:2},{value:"Les tests sont extr\xeamement lents sur le serveur Docker et/ou l&#39;int\xe9gration continue (CI).",id:"les-tests-sont-extr\xeamement-lents-sur-le-serveur-docker-etou-lint\xe9gration-continue-ci",level:2},{value:"<code>coveragePathIgnorePatterns</code> ne semble avoir aucun effet.",id:"coveragepathignorepatterns-ne-semble-avoir-aucun-effet",level:2},{value:"D\xe9finition des tests",id:"d\xe9finition-des-tests",level:2},{value:"Toujours pas de solution\xa0?",id:"toujours-pas-de-solution",level:2}];function p(e){const s=Object.assign({p:"p",h2:"h2",a:"a",code:"code",pre:"pre",admonition:"admonition",em:"em"},(0,r.ah)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.p,{children:"Oh oh, quelque chose s'est mal pass\xe9\xa0? Utilisez ce guide pour r\xe9soudre les probl\xe8mes avec Jest."}),"\n",(0,t.jsx)(s.h2,{id:"les-tests-\xe9chouent-et-vous-ne-savez-pourquoi",children:"Les tests \xe9chouent et vous ne savez pourquoi"}),"\n",(0,t.jsxs)(s.p,{children:["Try using the ",(0,t.jsx)(s.a,{href:"https://nodejs.org/api/debugger.html",children:"debugging support"})," built into Node. Placez l'instruction ",(0,t.jsx)(s.code,{children:"debugger;"})," dans l\u2019un de vos tests et puis, dans le r\xe9pertoire de votre projet, ex\xe9cutez\xa0:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"node --inspect-brk node_modules/.bin/jest --runInBand [tout autre argument ici]\nou sous Windows\nnode --inspect-brk ./node_modules/jest/bin/jest.js --runInBand [tout autre argument ici]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Cela ex\xe9cutera Jest dans un processus de Node auquel un d\xe9bogueur externe peut se connecter. Notez que le processus sera mis en pause jusqu'\xe0 ce que le d\xe9bogueur s'y soit connect\xe9."}),"\n",(0,t.jsxs)(s.p,{children:["Pour d\xe9boguer dans Google Chrome (ou n'importe quel navigateur bas\xe9 sur Chromium), ouvrez votre navigateur et allez dans ",(0,t.jsx)(s.code,{children:"chrome://inspect"})," et cliquez sur \xab\xa0Open Dedicated DevTools for Node\xa0\xbb, qui vous donnera une liste d'instances de node disponibles auxquelles vous pouvez vous connecter. Cliquez sur l'adresse affich\xe9e dans le terminal (g\xe9n\xe9ralement quelque chose comme ",(0,t.jsx)(s.code,{children:"localhost:9229"}),") apr\xe8s avoir ex\xe9cut\xe9 la commande ci-dessus, et vous serez en mesure de d\xe9boguer Jest en utilisant DevTools de Chrome."]}),"\n",(0,t.jsxs)(s.p,{children:["Les outils de d\xe9veloppement Chrome seront affich\xe9s, et un point d'arr\xeat sera d\xe9fini \xe0 la premi\xe8re ligne du script CLI de Jest (ceci est fait pour vous donner le temps d'ouvrir les outils de d\xe9veloppement et pour emp\xeacher Jest de s'ex\xe9cuter avant que vous ayez le temps de le faire). Cliquez sur le bouton qui ressemble \xe0 un bouton \xab play \xbb en haut \xe0 droite de l'\xe9cran pour continuer l'ex\xe9cution. Lorsque Jest ex\xe9cute le test qui contient l'instruction ",(0,t.jsx)(s.code,{children:"debugger"})," , l'ex\xe9cution se met en pause et vous pouvez examiner la port\xe9e actuelle et la pile d'appels."]}),"\n",(0,t.jsx)(s.admonition,{title:"remarque",type:"note",children:(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"--runInBand"})," cli option makes sure Jest runs the test in the same process rather than spawning processes for individual tests. Normalement, Jest parall\xe9lise les tests \xe0 travers les processus, mais il est difficile de d\xe9boguer plusieurs processus en m\xeame temps."]})}),"\n",(0,t.jsx)(s.h2,{id:"d\xe9bogage-dans-vs-code",children:"D\xe9bogage dans VS Code"}),"\n",(0,t.jsxs)(s.p,{children:["Il y a plusieurs fa\xe7ons de d\xe9boguer les tests Jest avec le ",(0,t.jsx)(s.a,{href:"https://code.visualstudio.com/docs/nodejs/nodejs-debugging",children:"d\xe9bogueur"})," int\xe9gr\xe9 de ",(0,t.jsx)(s.a,{href:"https://code.visualstudio.com",children:"Visual Studio Code"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"Pour attacher le d\xe9bogueur int\xe9gr\xe9, ex\xe9cutez vos tests comme mentionn\xe9 pr\xe9c\xe9demment\xa0:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"node --inspect-brk node_modules/.bin/jest --runInBand [tout autre argument ici]\nou sous Windows\nnode --inspect-brk ./node_modules/jest/bin/jest.js --runInBand [tout autre argument ici]\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Rattachez ensuite le d\xe9bogueur de VS Code en utilisant la configuration ",(0,t.jsx)(s.code,{children:"launch.json"})," suivante\xa0:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "version": "0.2.0",\n  "configurations": [\n    {\n      "type": "node",\n      "request": "attach",\n      "name": "Attach",\n      "port": 9229\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(s.p,{children:"Pour lancer et rattacher automatiquement un processus ex\xe9cutant vos tests, utilisez la configuration suivante\xa0:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "version": "0.2.0",\n  "configurations": [\n    {\n      "name": "Debug Jest Tests",\n      "type": "node",\n      "request": "launch",\n      "runtimeArgs": [\n        "--inspect-brk",\n        "${workspaceRoot}/node_modules/.bin/jest",\n        "--runInBand"\n      ],\n      "console": "integratedTerminal",\n      "internalConsoleOptions": "neverOpen"\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(s.p,{children:"ou ce qui suit pour Windows\xa0:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "version": "0.2.0",\n  "configurations": [\n    {\n      "name": "Debug Jest Tests",\n      "type": "node",\n      "request": "launch",\n      "runtimeArgs": [\n        "--inspect-brk",\n        "${workspaceRoot}/node_modules/jest/bin/jest.js",\n        "--runInBand"\n      ],\n      "console": "integratedTerminal",\n      "internalConsoleOptions": "neverOpen"\n    }\n  ]\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:["Si vous utilisez l'application ",(0,t.jsx)(s.a,{href:"https://github.com/facebookincubator/create-react-app",children:(0,t.jsx)(s.code,{children:"create-react-app"})})," de Facebook, vous pouvez d\xe9boguer vos tests Jest avec la configuration suivante\xa0:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "version": "0.2.0",\n  "configurations": [\n    {\n      "name": "Debug CRA Tests",\n      "type": "node",\n      "request": "launch",\n      "runtimeExecutable": "${workspaceRoot}/node_modules/.bin/react-scripts",\n      "args": [\n        "test",\n        "--runInBand",\n        "--no-cache",\n        "--env=jsdom",\n        "--watchAll=false"\n      ],\n      "cwd": "${workspaceRoot}",\n      "console": "integratedTerminal",\n      "internalConsoleOptions": "neverOpen"\n    }\n  ]\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:["Plus d'informations sur le d\xe9bogage de Node peuvent \xeatre trouv\xe9es ",(0,t.jsx)(s.a,{href:"https://nodejs.org/api/debugger.html",children:"ici"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"d\xe9bogage-dans-webstorm",children:"D\xe9bogage dans WebStorm"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.a,{href:"https://www.jetbrains.com/webstorm/",children:"WebStorm"})," a un support int\xe9gr\xe9 pour Jest. Lisez ",(0,t.jsx)(s.a,{href:"https://blog.jetbrains.com/webstorm/2018/10/testing-with-jest-in-webstorm/",children:"Tester avec Jest dans WebStorm"})," pour en savoir plus."]}),"\n",(0,t.jsx)(s.h2,{id:"probl\xe8mes-de-cache",children:"Probl\xe8mes de Cache"}),"\n",(0,t.jsx)(s.p,{children:"Le script de transformation a \xe9t\xe9 modifi\xe9 ou Babel a \xe9t\xe9 mis \xe0 jour et les changements ne sont pas reconnus par Jest\xa0?"}),"\n",(0,t.jsxs)(s.p,{children:["R\xe9essayez avec ",(0,t.jsx)(s.a,{href:"/fr/docs/next/cli#--cache",children:(0,t.jsx)(s.code,{children:"--no-cache"})}),". Jest met en cache les fichiers de modules transform\xe9s pour acc\xe9l\xe9rer l'ex\xe9cution des tests. Si vous utilisez votre propre transformateur personnalis\xe9, pensez \xe0 ajouter une fonction ",(0,t.jsx)(s.code,{children:"getCacheKey"})," \xe0 celle-ci\xa0: ",(0,t.jsx)(s.a,{href:"https://github.com/facebook/relay/blob/58cf36c73769690f0bbf90562707eadb062b029d/scripts/jest/preprocessor.js#L56-L61",children:"getCacheKey dans Relay"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"promesses-non-r\xe9solues",children:"Promesses non r\xe9solues"}),"\n",(0,t.jsx)(s.p,{children:"Si une promesse n'est pas r\xe9solue du tout, cette erreur peut \xeatre lev\xe9e\xa0:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"- Error: Timeout - Async callback was not invoked within timeout specified by jasmine.DEFAULT_TIMEOUT_INTERVAL.`\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Le plus souvent, ce probl\xe8me est caus\xe9 par des impl\xe9mentations conflictuelles de promesses. Envisagez de remplacer l'impl\xe9mentation de la promesse globale par la v\xf4tre, par exemple ",(0,t.jsx)(s.code,{children:"globalThis.Promise = jest.requireActual('promise');"})," et/ou consolidez les biblioth\xe8ques de promesses utilis\xe9es en une seule."]}),"\n",(0,t.jsxs)(s.p,{children:["Si votre test s'ex\xe9cute de mani\xe8re prolong\xe9e, vous pouvez envisager d'augmenter le d\xe9lai d'attente en appelant ",(0,t.jsx)(s.code,{children:"jest.setTimeout"})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"jest.setTimeout(10000); // timeout de 10 secondes\n"})}),"\n",(0,t.jsx)(s.h2,{id:"probl\xe8mes-de-watchman",children:"Probl\xe8mes de Watchman"}),"\n",(0,t.jsxs)(s.p,{children:["Essayez d'ex\xe9cuter Jest avec ",(0,t.jsx)(s.a,{href:"/fr/docs/next/cli#--watchman",children:(0,t.jsx)(s.code,{children:"--no-watchman"})})," ou d\xe9finissez l'option de configuration ",(0,t.jsx)(s.code,{children:"watchman"})," \xe0 ",(0,t.jsx)(s.code,{children:"false"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["Consulter aussi ",(0,t.jsx)(s.a,{href:"https://facebook.github.io/watchman/docs/troubleshooting",children:"d\xe9pannage de watchman"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"les-tests-sont-extr\xeamement-lents-sur-le-serveur-docker-etou-lint\xe9gration-continue-ci",children:"Les tests sont extr\xeamement lents sur le serveur Docker et/ou l'int\xe9gration continue (CI)."}),"\n",(0,t.jsxs)(s.p,{children:["While Jest is most of the time extremely fast on modern multi-core computers with fast SSDs, it may be slow on certain setups as our users ",(0,t.jsx)(s.a,{href:"https://github.com/jestjs/jest/issues/1395",children:"have"})," ",(0,t.jsx)(s.a,{href:"https://github.com/jestjs/jest/issues/1524#issuecomment-260246008",children:"discovered"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["Based on the ",(0,t.jsx)(s.a,{href:"https://github.com/jestjs/jest/issues/1524#issuecomment-262366820",children:"findings"}),", one way to mitigate this issue and improve the speed by up to 50% is to run tests sequentially."]}),"\n",(0,t.jsxs)(s.p,{children:["Pour ce faire, vous pouvez ex\xe9cuter les tests dans le m\xeame processus en utilisant ",(0,t.jsx)(s.a,{href:"/fr/docs/next/cli#--runinband",children:(0,t.jsx)(s.code,{children:"--runInBand"})}),"\xa0:"]}),"\n",(0,t.jsxs)(o.Z,{groupId:"npm2yarn",children:[(0,t.jsx)(a.Z,{value:"npm",children:(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Using Jest CLI\njest --runInBand\n\n# Using your package manager's `test` script (e.g. with create-react-app)\nnpm test -- --runInBand\n"})})}),(0,t.jsx)(a.Z,{value:"yarn",label:"Yarn",children:(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Using Jest CLI\njest --runInBand\n\n# Using your package manager's `test` script (e.g. with create-react-app)\nyarn test --runInBand\n"})})}),(0,t.jsx)(a.Z,{value:"pnpm",label:"pnpm",children:(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Using Jest CLI\njest --runInBand\n\n# Using your package manager's `test` script (e.g. with create-react-app)\npnpm test -- --runInBand\n"})})})]}),"\n",(0,t.jsxs)(s.p,{children:["Une autre alternative pour acc\xe9l\xe9rer le temps d'ex\xe9cution des tests sur les serveurs d'int\xe9gration continue tels que Travis-CI est de d\xe9finir le nombre maximal de workers \xe0 ~",(0,t.jsx)(s.em,{children:"4"}),". En particulier sur Travis-CI, cela peut r\xe9duire de moiti\xe9 le temps d'ex\xe9cution des tests. Remarque\xa0: le forfait ",(0,t.jsx)(s.em,{children:"gratuit"})," de Travis CI disponible pour les projets open source ne comprend que 2 c\u0153urs de processeur."]}),"\n",(0,t.jsxs)(o.Z,{groupId:"npm2yarn",children:[(0,t.jsx)(a.Z,{value:"npm",children:(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Using Jest CLI\njest --maxWorkers=4\n\n# Using your package manager's `test` script (e.g. with create-react-app)\nnpm test -- --maxWorkers=4\n"})})}),(0,t.jsx)(a.Z,{value:"yarn",label:"Yarn",children:(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Using Jest CLI\njest --maxWorkers=4\n\n# Using your package manager's `test` script (e.g. with create-react-app)\nyarn test --maxWorkers=4\n"})})}),(0,t.jsx)(a.Z,{value:"pnpm",label:"pnpm",children:(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Using Jest CLI\njest --maxWorkers=4\n\n# Using your package manager's `test` script (e.g. with create-react-app)\npnpm test -- --maxWorkers=4\n"})})})]}),"\n",(0,t.jsxs)(s.p,{children:["Si vous utilisez des actions GitHub, vous pouvez utiliser ",(0,t.jsx)(s.a,{href:"https://github.com/SimenB/github-actions-cpu-cores",children:(0,t.jsx)(s.code,{children:"github-actions-cpu-cores"})})," pour d\xe9tecter le nombre de processeurs, et le passer \xe0 Jest."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yaml",children:"- name: Get number of CPU cores\n  id: cpu-cores\n  uses: SimenB/github-actions-cpu-cores@v1\n- name: run tests\n  run: yarn jest --max-workers ${{ steps.cpu-cores.outputs.count }}\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Une autre chose que vous pouvez faire est d'utiliser l'option ",(0,t.jsx)(s.a,{href:"/fr/docs/next/cli#--shard",children:(0,t.jsx)(s.code,{children:"shard"})})," pour parall\xe9liser l'ex\xe9cution de test sur plusieurs machines."]}),"\n",(0,t.jsxs)(s.h2,{id:"coveragepathignorepatterns-ne-semble-avoir-aucun-effet",children:[(0,t.jsx)(s.code,{children:"coveragePathIgnorePatterns"})," ne semble avoir aucun effet."]}),"\n",(0,t.jsxs)(s.p,{children:["Assurez-vous que vous n'utilisez pas le plugin ",(0,t.jsx)(s.code,{children:"babel-plugin-istanbul"}),". Jest enveloppe Istanbul, et indique donc \xe9galement \xe0 Istanbul quels fichiers doivent \xeatre trait\xe9s avec la collection de couverture. Lors de l'utilisation de ",(0,t.jsx)(s.code,{children:"babel-plugin-istanbul"}),", chaque fichier qui est trait\xe9 par Babel aura un code de collecte de couverture, donc il ne sera pas ignor\xe9 par ",(0,t.jsx)(s.code,{children:"coveragePathIgnorePatterns"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"d\xe9finition-des-tests",children:"D\xe9finition des tests"}),"\n",(0,t.jsx)(s.p,{children:"Les tests doivent \xeatre d\xe9finis de mani\xe8re synchronis\xe9e pour que Jest puisse collecter vos tests."}),"\n",(0,t.jsx)(s.p,{children:"Comme exemple pour montrer pourquoi c'est le cas, imaginez que nous avons \xe9crit un tel test\xa0:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"// Ne le faites pas, cela ne fonctionnera pas\nsetTimeout(() => {\n  it('passes', () => expect(1).toBe(1));\n}, 0);\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Lorsque Jest ex\xe9cute votre test pour collecter les ",(0,t.jsx)(s.code,{children:"test"}),"s, il n'en trouvera aucun car nous avons configur\xe9 la d\xe9finition pour qu'elle se produise de mani\xe8re asynchrone au prochain d\xe9clenchement de la boucle d'\xe9v\xe9nement. This means when you are using ",(0,t.jsx)(s.code,{children:"test.each"})," you cannot set the table asynchronously within a ",(0,t.jsx)(s.code,{children:"beforeEach"})," / ",(0,t.jsx)(s.code,{children:"beforeAll"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"toujours-pas-de-solution",children:"Toujours pas de solution\xa0?"}),"\n",(0,t.jsxs)(s.p,{children:["Consultez l'",(0,t.jsx)(s.a,{href:"/help",children:"aide"}),"."]})]})}const h=function(e={}){const{wrapper:s}=Object.assign({},(0,r.ah)(),e.components);return s?(0,t.jsx)(s,Object.assign({},e,{children:(0,t.jsx)(p,e)})):p(e)}},1670:(e,s,n)=>{n.d(s,{Zo:()=>i,ah:()=>o});var t=n(7378);const r=t.createContext({});function o(e){const s=t.useContext(r);return t.useMemo((()=>"function"==typeof e?e(s):{...s,...e}),[s,e])}const a={};function i({components:e,children:s,disableParentContext:n}){let i;return i=n?"function"==typeof e?e({}):e||a:o(e),t.createElement(r.Provider,{value:i},s)}}}]);