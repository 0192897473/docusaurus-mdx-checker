"use strict";(self.webpackChunkjest_website=self.webpackChunkjest_website||[]).push([[1766],{7325:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var a=n(4246),i=n(1670);const r={id:"tutorial-react-native",title:"Testarea aplica\u021biilor React Native"},s=void 0,o={unversionedId:"tutorial-react-native",id:"tutorial-react-native",title:"Testarea aplica\u021biilor React Native",description:"At Facebook, we use Jest to test React Native applications.",source:"@site/i18n/ro/docusaurus-plugin-content-docs/current/TutorialReactNative.md",sourceDirName:".",slug:"/tutorial-react-native",permalink:"/ro/docs/next/tutorial-react-native",draft:!1,unlisted:!1,editUrl:"https://crowdin.com/project/jest-v2/ro",tags:[],version:"current",frontMatter:{id:"tutorial-react-native",title:"Testarea aplica\u021biilor React Native"},sidebar:"docs",previous:{title:"Testarea aplica\u021biilor React",permalink:"/ro/docs/next/tutorial-react"},next:{title:"Testing Web Frameworks",permalink:"/ro/docs/next/testing-frameworks"}},c={},l=[{value:"Instalare",id:"instalare",level:2},{value:"Testarea de imagine",id:"testarea-de-imagine",level:2},{value:"Configurarea preset\u0103rii",id:"configurarea-preset\u0103rii",level:2},{value:"Mediu",id:"mediu",level:3},{value:"Personaliz\u0103ri de transformIgnorePatterns",id:"personaliz\u0103ri-de-transformignorepatterns",level:3},{value:"setupFiles",id:"setupfiles",level:3},{value:"moduleNameMapper",id:"modulenamemapper",level:3},{value:"Recomand\u0103ri",id:"recomand\u0103ri",level:2},{value:"Mock-ui\u021bi module native cu jest.mock",id:"mock-ui\u021bi-module-native-cu-jestmock",level:3}];function d(e){const t=Object.assign({p:"p",a:"a",h2:"h2",code:"code",pre:"pre",admonition:"admonition",h3:"h3",strong:"strong"},(0,i.ah)(),e.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.p,{children:["At Facebook, we use Jest to test ",(0,a.jsx)(t.a,{href:"https://reactnative.dev/",children:"React Native"})," applications."]}),"\n",(0,a.jsxs)(t.p,{children:["Dob\xe2ndi\u021bi o \xeen\u0163elegere mai profund\u0103 \xeen testarea unei aplica\u021bii exemplu React Native citind urm\u0103toarele serii: ",(0,a.jsx)(t.a,{href:"https://callstack.com/blog/testing-react-native-with-the-new-jest-part-1-snapshots-come-into-play/",children:"Partea 1: Jest \u2013 Instantaneele intr\u0103 \xeen joc"})," \u015fi ",(0,a.jsx)(t.a,{href:"https://callstack.com/blog/testing-react-native-with-the-new-jest-part-2-redux-snapshots-for-your-actions-and-reducers/",children:"Partea 2: Jest \u2013 Instantanee Redux pentru Ac\u0163iuni \u015fi Reductori"}),"."]}),"\n",(0,a.jsx)(t.h2,{id:"instalare",children:"Instalare"}),"\n",(0,a.jsxs)(t.p,{children:["Incepand cu versiunea react-native 0.38, instalarea Jest este inclus\u0103 implicit atunci c\xe2nd se ruleaz\u0103 ",(0,a.jsx)(t.code,{children:"react-native init"}),". Urmatoarea configuratie ar trebui s\u0103 fie ad\u0103ugat\u0103 automat \xeen fi\u015fierul package.json:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'{\n  "scripts": {\n    "test": "jest"\n  },\n  "jest": {\n    "preset": "react-native"\n  }\n}\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Run ",(0,a.jsx)(t.code,{children:"yarn test"})," to run tests with Jest."]}),"\n",(0,a.jsx)(t.admonition,{type:"tip",children:(0,a.jsxs)(t.p,{children:["If you are upgrading your react-native application and previously used the ",(0,a.jsx)(t.code,{children:"jest-react-native"})," preset, remove the dependency from your ",(0,a.jsx)(t.code,{children:"package.json"})," file and change the preset to ",(0,a.jsx)(t.code,{children:"react-native"})," instead."]})}),"\n",(0,a.jsx)(t.h2,{id:"testarea-de-imagine",children:"Testarea de imagine"}),"\n",(0,a.jsxs)(t.p,{children:["S\u0103 cre\u0103m un ",(0,a.jsx)(t.a,{href:"/ro/docs/next/snapshot-testing",children:"test de imagine"})," pentru o component\u0103 micu\u021b\u0103 cu c\xe2teva view-uri \u015fi componente de text \u015fi unele stiluri:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="Intro.js"',children:"import React, {Component} from 'react';\nimport {StyleSheet, Text, View} from 'react-native';\n\nclass Intro extends Component {\n  render() {\n    return (\n      <View style={styles.container}>\n        <Text style={styles.welcome}>Welcome to React Native!</Text>\n        <Text style={styles.instructions}>\n          This is a React Native snapshot test.\n        </Text>\n      </View>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: 'center',\n    backgroundColor: '#F5FCFF',\n    flex: 1,\n    justifyContent: 'center',\n  },\n  instructions: {\n    color: '#333333',\n    marginBottom: 5,\n    textAlign: 'center',\n  },\n  welcome: {\n    fontSize: 20,\n    margin: 10,\n    textAlign: 'center',\n  },\n});\n\nexport default Intro;\n"})}),"\n",(0,a.jsx)(t.p,{children:"Acum haide\u0163i s\u0103 utiliz\u0103m procesorul de randare React \u015fi func\u021bionalitatea din Jest pentru testarea de imagine pentru a interac\u0163iona cu componenta \u015fi a captura rezultatul \u015fi a crea un fi\u015fier de imagine:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="__tests__/Intro-test.js"',children:"import React from 'react';\nimport renderer from 'react-test-renderer';\nimport Intro from '../Intro';\n\ntest('renders correctly', () => {\n  const tree = renderer.create(<Intro />).toJSON();\n  expect(tree).toMatchSnapshot();\n});\n"})}),"\n",(0,a.jsxs)(t.p,{children:["When you run ",(0,a.jsx)(t.code,{children:"yarn test"})," or ",(0,a.jsx)(t.code,{children:"jest"}),", this will produce an output file like this:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",metastring:'title="__tests__/__snapshots__/Intro-test.js.snap"',children:'exports[`Intro renders correctly 1`] = `\n<View\n  style={\n    Object {\n      "alignItems": "center",\n      "backgroundColor": "#F5FCFF",\n      "flex": 1,\n      "justifyContent": "center",\n    }\n  }>\n  <Text\n    style={\n      Object {\n        "fontSize": 20,\n        "margin": 10,\n        "textAlign": "center",\n      }\n    }>\n    Welcome to React Native!\n  </Text>\n  <Text\n    style={\n      Object {\n        "color": "#333333",\n        "marginBottom": 5,\n        "textAlign": "center",\n      }\n    }>\n    This is a React Native snapshot test.\n  </Text>\n</View>\n`;\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Data viitoare c\xe2nd executa\u0163i testele, rezultatul va fi comparat cu imaginea creat\u0103 anterior. The snapshot should be committed along with code changes. Atunci c\xe2nd un test de imagine e\u0219ueaz\u0103, trebuie s\u0103 inspecta\u021bi dac\u0103 este vorba de o modificare inten\u021bionat\u0103 sau neinten\u0163ionat\u0103. \xcen cazul \xeen care schimbarea este inten\u021bionat\u0103 se poate apela Jest cu ",(0,a.jsx)(t.code,{children:"jest -u"})," pentru a suprascrie imaginea existent\u0103."]}),"\n",(0,a.jsxs)(t.p,{children:["The code for this example is available at ",(0,a.jsx)(t.a,{href:"https://github.com/jestjs/jest/tree/main/examples/react-native",children:"examples/react-native"}),"."]}),"\n",(0,a.jsx)(t.h2,{id:"configurarea-preset\u0103rii",children:"Configurarea preset\u0103rii"}),"\n",(0,a.jsx)(t.p,{children:"Presetarea ini\u021bializeaz\u0103 mediul \u015fi este foarte dogmatic \u0219i se bazeaz\u0103 pe ceea ce am g\u0103sit a fi util la Facebook. Toate op\u0163iunile de configurare pot fi suprascrise a\u015fa cum acestea pot fi personalizate atunci c\xe2nd nu se utilizeaz\u0103 nicio presetare."}),"\n",(0,a.jsx)(t.h3,{id:"mediu",children:"Mediu"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"react-native"})," este livrat cu o presetare Jest, astfel \xeenc\xe2t c\xe2mpul ",(0,a.jsx)(t.code,{children:"jest.preset"})," din ",(0,a.jsx)(t.code,{children:"package.json"})," ar trebui s\u0103 indice c\u0103tre ",(0,a.jsx)(t.code,{children:"react-native"}),". The preset is a node environment that mimics the environment of a React Native app. Because it doesn't load any DOM or browser APIs, it greatly improves Jest's startup time."]}),"\n",(0,a.jsx)(t.h3,{id:"personaliz\u0103ri-de-transformignorepatterns",children:"Personaliz\u0103ri de transformIgnorePatterns"}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.a,{href:"configuration#transformignorepatterns-arraystring",children:(0,a.jsx)(t.code,{children:"transformIgnorePatterns"})})," option can be used to specify which files shall be transformed by Babel. Many ",(0,a.jsx)(t.code,{children:"react-native"})," npm modules unfortunately don't pre-compile their source code before publishing."]}),"\n",(0,a.jsxs)(t.p,{children:["By default the ",(0,a.jsx)(t.code,{children:"jest-react-native"})," preset only processes the project's own source files and ",(0,a.jsx)(t.code,{children:"react-native"}),". If you have npm dependencies that have to be transformed you can customize this configuration option by including modules other than ",(0,a.jsx)(t.code,{children:"react-native"})," by grouping them and separating them with the ",(0,a.jsx)(t.code,{children:"|"})," operator:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'{\n  "transformIgnorePatterns": [\n    "node_modules/(?!(react-native|my-project|react-native-button)/)"\n  ]\n}\n'})}),"\n",(0,a.jsxs)(t.p,{children:["You can test which paths would match (and thus be excluded from transformation) with a tool ",(0,a.jsx)(t.a,{href:"https://regex101.com/r/JsLIDM/1",children:"like this"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"transformIgnorePatterns"})," will exclude a file from transformation if the path matches against ",(0,a.jsx)(t.strong,{children:"any"})," pattern provided. Splitting into multiple patterns could therefore have unintended results if you are not careful. In the example below, the exclusion (also known as a negative lookahead assertion) for ",(0,a.jsx)(t.code,{children:"foo"})," and ",(0,a.jsx)(t.code,{children:"bar"})," cancel each other out:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'{\n  "transformIgnorePatterns": ["node_modules/(?!foo/)", "node_modules/(?!bar/)"] // not what you want\n}\n'})}),"\n",(0,a.jsx)(t.h3,{id:"setupfiles",children:"setupFiles"}),"\n",(0,a.jsxs)(t.p,{children:["Dac\u0103 dori\u0163i s\u0103 specifica\u021bi configur\u0103ri suplimentare pentru fiecare fi\u015fier de test, ",(0,a.jsxs)(t.a,{href:"configuration.html#setupfiles-array",children:["op\u0163iunea de configurare ",(0,a.jsx)(t.code,{children:"setupFiles"})]})," poate fi folosit\u0103 pentru a specifica script-uri de ini\u021bializare."]}),"\n",(0,a.jsx)(t.h3,{id:"modulenamemapper",children:"moduleNameMapper"}),"\n",(0,a.jsxs)(t.p,{children:["Op\u021biunea ",(0,a.jsxs)(t.a,{href:"configuration#modulenamemapper-objectstring-string--arraystring",children:[" ",(0,a.jsx)(t.code,{children:"moduleNameMapper"})]})," poate fi utilizat\u0103 pentru maparea o cale de modul c\u0103tre un modul diferit. \xcen mod implicit presetarea mapeaz\u0103 toate imaginile c\u0103tre un modul dublur\u0103 de imagine dar dac\u0103 un modul nu poate fi g\u0103sit aceast\u0103 op\u0163iune de configurare poate ajuta:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'{\n  "moduleNameMapper": {\n    "my-module.js": "<rootDir>/path/to/my-module.js"\n  }\n}\n'})}),"\n",(0,a.jsx)(t.h2,{id:"recomand\u0103ri",children:"Recomand\u0103ri"}),"\n",(0,a.jsx)(t.h3,{id:"mock-ui\u021bi-module-native-cu-jestmock",children:"Mock-ui\u021bi module native cu jest.mock"}),"\n",(0,a.jsxs)(t.p,{children:["Presetarea Jest incorporat\u0103 \xeen ",(0,a.jsx)(t.code,{children:"react-native"})," vine cu c\xe2teva mock-uri implicite, care sunt aplicate pe un proiect react-native. However, some react-native components or third party components rely on native code to be rendered. \xcen astfel de cazuri, sistem manual de mocking din Jest poate ajuta pentru dublarea implement\u0103rii."]}),"\n",(0,a.jsxs)(t.p,{children:["De exemplu, \xeen cazul \xeen care codul vostru depinde de o component\u0103 video nativ\u0103 extern\u0103 numit\u0103 ",(0,a.jsx)(t.code,{children:"react-native-video"})," a\u0163i putea-o dubla cu un mock manual \xeen felul urm\u0103tor:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"jest.mock('react-native-video', () => 'Video');\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Acest lucru va randa componenta ca ",(0,a.jsx)(t.code,{children:"<Video {...props} />"})," cu toate propriet\u0103\u021bile sale reg\u0103site \xeen instantaneu. See also ",(0,a.jsx)(t.a,{href:"tutorial-react#snapshot-testing-with-mocks-enzyme-and-react-16",children:"caveats around Enzyme and React 16"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"Uneori, este nevoie s\u0103 furniza\u021bi o dublur\u0103 manual\u0103 mai complex\u0103. De exemplu \xeen cazul \xeen care dori\u0163i s\u0103 redirec\u0163iona\u0163i propriet\u0103\u021bi sau c\xe2mpuri statice ale unei componente native c\u0103tre mock, pute\u0163i returna o component\u0103 React diferit\u0103 dintr-un mock prin acest ajutor din jest-react-native:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"jest.mock('path/to/MyNativeComponent', () => {\n  const mockComponent = require('react-native/jest/mockComponent');\n  return mockComponent('path/to/MyNativeComponent');\n});\n"})}),"\n",(0,a.jsx)(t.p,{children:"Sau dac\u0103 dori\u0163i s\u0103 v\u0103 crea\u021bi propriul mock manual, pute\u0163i face ceva de genul acesta:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"jest.mock('Text', () => {\n  const RealComponent = jest.requireActual('Text');\n  const React = require('react');\n  class Text extends React.Component {\n    render() {\n      return React.createElement('Text', this.props, this.props.children);\n    }\n  }\n  Text.propTypes = RealComponent.propTypes;\n  return Text;\n});\n"})}),"\n",(0,a.jsx)(t.p,{children:"\xcen alte cazuri, poate dori\u0163i s\u0103 mock-ui\u021bi un modul nativ, care nu este o component\u0103 React. Aceea\u0219i tehnic\u0103 poate fi aplicat\u0103. Se recomand\u0103 inspectarea codului surs\u0103 din modulul nativ \u015fi logarea atunci c\xe2nd ruleaz\u0103 o aplica\u0163ie react native pe un dispozitiv real \u015fi apoi modelarea unui mock manual dup\u0103 modulul real."}),"\n",(0,a.jsxs)(t.p,{children:["Dac\u0103 ajunge\u021bi s\u0103 mock-ui\u021bi acelea\u0219i module de multe ori este recomandat\u0103 definirea acestor mock-uri \xeentr-un fi\u015fier separat \u015fi ad\u0103ugarea lor la lista de ",(0,a.jsx)(t.code,{children:"setupFiles"}),"."]})]})}const u=function(e={}){const{wrapper:t}=Object.assign({},(0,i.ah)(),e.components);return t?(0,a.jsx)(t,Object.assign({},e,{children:(0,a.jsx)(d,e)})):d(e)}},1670:(e,t,n)=>{n.d(t,{Zo:()=>o,ah:()=>r});var a=n(7378);const i=a.createContext({});function r(e){const t=a.useContext(i);return a.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}const s={};function o({components:e,children:t,disableParentContext:n}){let o;return o=n?"function"==typeof e?e({}):e||s:r(e),a.createElement(i.Provider,{value:o},t)}}}]);