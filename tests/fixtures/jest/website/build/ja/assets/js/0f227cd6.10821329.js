"use strict";(self.webpackChunkjest_website=self.webpackChunkjest_website||[]).push([[744],{3436:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var s=t(4246),o=t(1670);const a={id:"setup-teardown",title:"\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3068\u7834\u68c4"},c=void 0,r={unversionedId:"setup-teardown",id:"setup-teardown",title:"\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3068\u7834\u68c4",description:"\u30c6\u30b9\u30c8\u3092\u66f8\u3044\u3066\u3044\u308b\u969b\u306b\u3057\u3070\u3057\u3070\u3001\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b\u524d\u306b\u3044\u304f\u3064\u304b\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u4f5c\u696d\u3092\u3057\u305f\u308a\u3001\u30c6\u30b9\u30c8\u304c\u7d42\u4e86\u3057\u305f\u5f8c\u306b\u3044\u304f\u3064\u304b\u306e\u4ed5\u4e0a\u3052\u4f5c\u696d\u3092\u3057\u305f\u3044\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002 Jest \u306f\u3053\u308c\u3089\u3092\u51e6\u7406\u3059\u308b\u30d8\u30eb\u30d1\u30fc\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002",source:"@site/i18n/ja/docusaurus-plugin-content-docs/current/SetupAndTeardown.md",sourceDirName:".",slug:"/setup-teardown",permalink:"/ja/docs/next/setup-teardown",draft:!1,unlisted:!1,editUrl:"https://crowdin.com/project/jest-v2/ja",tags:[],version:"current",frontMatter:{id:"setup-teardown",title:"\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3068\u7834\u68c4"},sidebar:"docs",previous:{title:"\u975e\u540c\u671f\u30b3\u30fc\u30c9\u306e\u30c6\u30b9\u30c8",permalink:"/ja/docs/next/asynchronous"},next:{title:"\u30e2\u30c3\u30af\u95a2\u6570",permalink:"/ja/docs/next/mock-functions"}},i={},l=[{value:"\u7e70\u308a\u8fd4\u3057\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7",id:"\u7e70\u308a\u8fd4\u3057\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7",level:2},{value:"\u30ef\u30f3\u30bf\u30a4\u30e0\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7",id:"\u30ef\u30f3\u30bf\u30a4\u30e0\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7",level:2},{value:"\u30b9\u30b3\u30fc\u30d7",id:"\u30b9\u30b3\u30fc\u30d7",level:2},{value:"Order of Execution",id:"order-of-execution",level:2},{value:"\u4e00\u822c\u7684\u306a\u30a2\u30c9\u30d0\u30a4\u30b9",id:"\u4e00\u822c\u7684\u306a\u30a2\u30c9\u30d0\u30a4\u30b9",level:2}];function d(e){const n=Object.assign({p:"p",h2:"h2",code:"code",pre:"pre",a:"a",em:"em",admonition:"admonition"},(0,o.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"\u30c6\u30b9\u30c8\u3092\u66f8\u3044\u3066\u3044\u308b\u969b\u306b\u3057\u3070\u3057\u3070\u3001\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b\u524d\u306b\u3044\u304f\u3064\u304b\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u4f5c\u696d\u3092\u3057\u305f\u308a\u3001\u30c6\u30b9\u30c8\u304c\u7d42\u4e86\u3057\u305f\u5f8c\u306b\u3044\u304f\u3064\u304b\u306e\u4ed5\u4e0a\u3052\u4f5c\u696d\u3092\u3057\u305f\u3044\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002 Jest \u306f\u3053\u308c\u3089\u3092\u51e6\u7406\u3059\u308b\u30d8\u30eb\u30d1\u30fc\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u7e70\u308a\u8fd4\u3057\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7",children:"\u7e70\u308a\u8fd4\u3057\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7"}),"\n",(0,s.jsxs)(n.p,{children:["\u591a\u304f\u306e\u30c6\u30b9\u30c8\u3067\u7e70\u308a\u8fd4\u3057\u884c\u3046\u5fc5\u8981\u304c\u3042\u308b\u5834\u5408\u306f\u3001",(0,s.jsx)(n.code,{children:"beforeEach"})," \u3068 ",(0,s.jsx)(n.code,{children:"afterEach"})," \u30d5\u30c3\u30af\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u305f\u3068\u3048\u3070\u3001\u3044\u304f\u3064\u304b\u306e\u30c6\u30b9\u30c8\u304c City \u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u95a2\u4fc2\u3059\u308b\u3068\u3057\u307e\u3057\u3087\u3046\u3002 \u305d\u3057\u3066\u3053\u308c\u3089\u306e\u30c6\u30b9\u30c8\u306e\u524d\u306b ",(0,s.jsx)(n.code,{children:"initializeCityDatabase()"})," \u3092\u547c\u3073\u51fa\u3059\u5fc5\u8981\u304c\u3042\u308a\u3001\u30c6\u30b9\u30c8\u306e\u5f8c\u306b\u306f",(0,s.jsx)(n.code,{children:"clearCityDatabase()"})," \u3092\u547c\u3073\u51fa\u3059\u5fc5\u8981\u304c\u3042\u308b\u3068\u3057\u307e\u3059\u3002 \u305d\u306e\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3067\u304d\u307e\u3059:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"beforeEach(() => {\n  initializeCityDatabase();\n});\n\nafterEach(() => {\n  clearCityDatabase();\n});\n\ntest('city database has Vienna', () => {\n  expect(isCity('Vienna')).toBeTruthy();\n});\n\ntest('city database has San Juan', () => {\n  expect(isCity('San Juan')).toBeTruthy();\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"beforeEach"})," \u3068 ",(0,s.jsx)(n.code,{children:"afterEach"})," \u306f",(0,s.jsx)(n.a,{href:"/ja/docs/next/asynchronous",children:"\u975e\u540c\u671f\u30b3\u30fc\u30c9\u3092\u30c6\u30b9\u30c8\u3059\u308b"})," \u3068\u540c\u69d8\u306b\u975e\u540c\u671f\u30b3\u30fc\u30c9\u3092\u6271\u3048\u307e\u3059 - promise \u3092\u8fd4\u3059\u304b ",(0,s.jsx)(n.code,{children:"done"})," \u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u3069\u3061\u3089\u304b\u3092\u9078\u629e\u3057\u307e\u3059\u3002 \u305f\u3068\u3048\u3070\u3001\u3082\u3057 ",(0,s.jsx)(n.code,{children:"initializeCityDatabase()"})," \u304c promise\u3092\u8fd4\u3059\u306e\u3067\u3042\u308c\u3070\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u521d\u671f\u5316\u3055\u308c\u305f\u969b\u306b\u306f promise \u304c\u8fd4\u3055\u308c\u308b\u3053\u3068\u304c\u671b\u307e\u308c\u307e\u3059\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"beforeEach(() => {\n  return initializeCityDatabase();\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u30ef\u30f3\u30bf\u30a4\u30e0\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7",children:"\u30ef\u30f3\u30bf\u30a4\u30e0\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7"}),"\n",(0,s.jsxs)(n.p,{children:["\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u304c\u30d5\u30a1\u30a4\u30eb\u306e\u5148\u982d\u3067\u4e00\u56de\u3060\u3051\u5b9f\u884c\u3055\u308c\u308b\u3053\u3068\u304c\u5fc5\u8981\u306a\u30b1\u30fc\u30b9\u304c\u3042\u308a\u307e\u3059\u3002 \u3053\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u304c\u975e\u540c\u671f\u3067\u884c\u308f\u308c\u308b\u5834\u5408\u306f\u7279\u306b\u9762\u5012\u306b\u306a\u308b\u306e\u3067\u3001\u30a4\u30f3\u30e9\u30a4\u30f3\u3067\u306f\u5b9f\u65bd\u3067\u304d\u307e\u305b\u3093\u3002 Jest provides ",(0,s.jsx)(n.code,{children:"beforeAll"})," and ",(0,s.jsx)(n.code,{children:"afterAll"})," hooks to handle this situation."]}),"\n",(0,s.jsxs)(n.p,{children:["For example, if both ",(0,s.jsx)(n.code,{children:"initializeCityDatabase()"})," and ",(0,s.jsx)(n.code,{children:"clearCityDatabase()"})," returned promises, and the city database could be reused between tests, we could change our test code to:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"beforeAll(() => {\n  return initializeCityDatabase();\n});\n\nafterAll(() => {\n  return clearCityDatabase();\n});\n\ntest('city database has Vienna', () => {\n  expect(isCity('Vienna')).toBeTruthy();\n});\n\ntest('city database has San Juan', () => {\n  expect(isCity('San Juan')).toBeTruthy();\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u30b9\u30b3\u30fc\u30d7",children:"\u30b9\u30b3\u30fc\u30d7"}),"\n",(0,s.jsxs)(n.p,{children:["The top level ",(0,s.jsx)(n.code,{children:"before*"})," and ",(0,s.jsx)(n.code,{children:"after*"})," hooks apply to every test in a file. The hooks declared inside a ",(0,s.jsx)(n.code,{children:"describe"})," block apply only to the tests within that ",(0,s.jsx)(n.code,{children:"describe"})," block."]}),"\n",(0,s.jsx)(n.p,{children:"\u305f\u3068\u3048\u3070\u3001\u90fd\u5e02\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3060\u3051\u3067\u306a\u304f\u3001\u98df\u54c1\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3082\u3042\u308b\u3068\u3057\u307e\u3059\u3002 \u30c6\u30b9\u30c8\u3054\u3068\u306b\u7570\u306a\u308b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Applies to all tests in this file\nbeforeEach(() => {\n  return initializeCityDatabase();\n});\n\ntest('city database has Vienna', () => {\n  expect(isCity('Vienna')).toBeTruthy();\n});\n\ntest('city database has San Juan', () => {\n  expect(isCity('San Juan')).toBeTruthy();\n});\n\ndescribe('matching cities to foods', () => {\n  // Applies only to tests in this describe block\n  beforeEach(() => {\n    return initializeFoodDatabase();\n  });\n\n  test('Vienna <3 veal', () => {\n    expect(isValidCityFoodPair('Vienna', 'Wiener Schnitzel')).toBe(true);\n  });\n\n  test('San Juan <3 plantains', () => {\n    expect(isValidCityFoodPair('San Juan', 'Mofongo')).toBe(true);\n  });\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u6700\u4e0a\u4f4d\u306e ",(0,s.jsx)(n.code,{children:"beforeEach"})," \u306f ",(0,s.jsx)(n.code,{children:"describe"})," \u5185\u306e ",(0,s.jsx)(n.code,{children:"beforeEach"})," \u3088\u308a\u524d\u306b\u5b9f\u884c\u3055\u308c\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002 \u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u5168\u30d5\u30c3\u30af\u306e\u9806\u5e8f\u304c\u7406\u89e3\u3067\u304d\u308b\u3068\u601d\u3044\u307e\u3059\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"beforeAll(() => console.log('1 - beforeAll'));\nafterAll(() => console.log('1 - afterAll'));\nbeforeEach(() => console.log('1 - beforeEach'));\nafterEach(() => console.log('1 - afterEach'));\n\ntest('', () => console.log('1 - test'));\n\ndescribe('Scoped / Nested block', () => {\n  beforeAll(() => console.log('2 - beforeAll'));\n  afterAll(() => console.log('2 - afterAll'));\n  beforeEach(() => console.log('2 - beforeEach'));\n  afterEach(() => console.log('2 - afterEach'));\n\n  test('', () => console.log('2 - test'));\n});\n\n// 1 - beforeAll\n// 1 - beforeEach\n// 1 - test\n// 1 - afterEach\n// 2 - beforeAll\n// 1 - beforeEach\n// 2 - beforeEach\n// 2 - test\n// 2 - afterEach\n// 1 - afterEach\n// 2 - afterAll\n// 1 - afterAll\n"})}),"\n",(0,s.jsx)(n.h2,{id:"order-of-execution",children:"Order of Execution"}),"\n",(0,s.jsxs)(n.p,{children:["Jest \u306f\u3001\u30c6\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u5185\u306e\u3059\u3079\u3066\u306e describe \u30cf\u30f3\u30c9\u30e9\u3092\u3001\u5b9f\u969b\u306e\u3059\u3079\u3066\u306e\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b",(0,s.jsx)(n.em,{children:"\u524d\u306b"}),"\u5b9f\u884c\u3057\u307e\u3059\u3002 This is another reason to do setup and teardown inside ",(0,s.jsx)(n.code,{children:"before*"})," and ",(0,s.jsx)(n.code,{children:"after*"})," handlers rather than inside the ",(0,s.jsx)(n.code,{children:"describe"})," blocks. Once the ",(0,s.jsx)(n.code,{children:"describe"})," blocks are complete, by default Jest runs all the tests serially in the order they were encountered in the collection phase, waiting for each to finish and be tidied up before moving on."]}),"\n",(0,s.jsx)(n.p,{children:"\u6b21\u306e\u3088\u3046\u306a\u8aac\u660e\u306e\u305f\u3081\u306e\u30c6\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3068\u305d\u306e\u51fa\u529b\u306b\u3064\u3044\u3066\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"describe('describe outer', () => {\n  console.log('describe outer-a');\n\n  describe('describe inner 1', () => {\n    console.log('describe inner 1');\n\n    test('test 1', () => console.log('test 1'));\n  });\n\n  console.log('describe outer-b');\n\n  test('test 2', () => console.log('test 2'));\n\n  describe('describe inner 2', () => {\n    console.log('describe inner 2');\n\n    test('test 3', () => console.log('test 3'));\n  });\n\n  console.log('describe outer-c');\n});\n\n// describe outer-a\n// describe inner 1\n// describe outer-b\n// describe inner 2\n// describe outer-c\n// test 1\n// test 2\n// test 3\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Just like the ",(0,s.jsx)(n.code,{children:"describe"})," and ",(0,s.jsx)(n.code,{children:"test"})," blocks Jest calls the ",(0,s.jsx)(n.code,{children:"before*"})," and ",(0,s.jsx)(n.code,{children:"after*"})," hooks in the order of declaration. Note that the ",(0,s.jsx)(n.code,{children:"after*"})," hooks of the enclosing scope are called first. For example, here is how you can set up and tear down resources which depend on each other:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"beforeEach(() => console.log('connection setup'));\nbeforeEach(() => console.log('database setup'));\n\nafterEach(() => console.log('database teardown'));\nafterEach(() => console.log('connection teardown'));\n\ntest('test 1', () => console.log('test 1'));\n\ndescribe('extra', () => {\n  beforeEach(() => console.log('extra database setup'));\n  afterEach(() => console.log('extra database teardown'));\n\n  test('test 2', () => console.log('test 2'));\n});\n\n// connection setup\n// database setup\n// test 1\n// database teardown\n// connection teardown\n\n// connection setup\n// database setup\n// extra database setup\n// test 2\n// extra database teardown\n// database teardown\n// connection teardown\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsxs)(n.p,{children:["If you are using ",(0,s.jsx)(n.code,{children:"jasmine2"})," test runner, take into account that it calls the ",(0,s.jsx)(n.code,{children:"after*"})," hooks in the reverse order of declaration. To have identical output, the above example should be altered like this:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"  beforeEach(() => console.log('connection setup'));\n+ afterEach(() => console.log('connection teardown'));\n\n  beforeEach(() => console.log('database setup'));\n+ afterEach(() => console.log('database teardown'));\n\n- afterEach(() => console.log('database teardown'));\n- afterEach(() => console.log('connection teardown'));\n\n  // ...\n"})})]}),"\n",(0,s.jsx)(n.h2,{id:"\u4e00\u822c\u7684\u306a\u30a2\u30c9\u30d0\u30a4\u30b9",children:"\u4e00\u822c\u7684\u306a\u30a2\u30c9\u30d0\u30a4\u30b9"}),"\n",(0,s.jsxs)(n.p,{children:["\u3082\u3057\u30c6\u30b9\u30c8\u304c\u5931\u6557\u3057\u3066\u3001\u307e\u305a\u6700\u521d\u306b\u8abf\u3079\u308b\u3079\u304d\u3053\u3068\u306e\u4e00\u3064\u306f\u305d\u306e\u30c6\u30b9\u30c8\u304c\u5358\u4f53\u3067\u5b9f\u884c\u3055\u308c\u305f\u5834\u5408\u306b\u3082\u5931\u6557\u3059\u308b\u304b\u3069\u3046\u304b\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002 Jest \u3067\u4e00\u5ea6\u3060\u3051\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b\u306b\u306f\u3001 ",(0,s.jsx)(n.code,{children:"test"})," \u30b3\u30de\u30f3\u30c9\u3092 ",(0,s.jsx)(n.code,{children:"test.only"})," \u306b\u4e00\u6642\u7684\u306b\u5909\u66f4\u3057\u307e\u3059\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"test.only('this will be the only test that runs', () => {\n  expect(true).toBe(false);\n});\n\ntest('this test will not run', () => {\n  expect('A').toBe('A');\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u3082\u3057\u3042\u306a\u305f\u304c\u3042\u308b\u7a0b\u5ea6\u306e\u5927\u304d\u3055\u306e\u30c6\u30b9\u30c8\u30b9\u30a4\u30fc\u30c8\u3092\u5b9f\u884c\u3057\u305f\u3068\u304d\u306b\u3042\u308b\u30c6\u30b9\u30c8\u304c\u5931\u6557\u3057\u3001\u305d\u306e\u30c6\u30b9\u30c8\u3092\u5358\u72ec\u3067\u5b9f\u884c\u3057\u305f\u3068\u304d\u306b\u306f\u5931\u6557\u3057\u306a\u3044\u5834\u5408\u306f\u3001\u304a\u305d\u3089\u304f\u5225\u306e\u30c6\u30b9\u30c8\u304c\u305d\u306e\u30c6\u30b9\u30c8\u306b\u5e72\u6e09\u3057\u3066\u3044\u308b\u3068\u8003\u3048\u3089\u308c\u307e\u3059\u3002 ",(0,s.jsx)(n.code,{children:"beforeEach"})," \u3067\u5171\u6709\u3055\u308c\u305f\u30b9\u30c6\u30fc\u30c8\u3092\u30af\u30ea\u30a2\u3059\u308b\u3053\u3068\u3067\u3057\u3070\u3057\u3070\u305d\u3046\u3044\u3063\u305f\u554f\u984c\u3092\u4fee\u6b63\u3067\u304d\u307e\u3059\u3002 \u5171\u6709\u3055\u308c\u305f\u30b9\u30c6\u30fc\u30c8\u304c\u5909\u66f4\u3055\u308c\u305f\u304b\u3069\u3046\u304b\u78ba\u4fe1\u304c\u3082\u3066\u306a\u3044\u5834\u5408\u306f\u3001",(0,s.jsx)(n.code,{children:"beforeEach"})," \u3092\u4f7f\u3063\u3066\u30c7\u30fc\u30bf\u306e\u30ed\u30b0\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002"]})]})}const h=function(e={}){const{wrapper:n}=Object.assign({},(0,o.ah)(),e.components);return n?(0,s.jsx)(n,Object.assign({},e,{children:(0,s.jsx)(d,e)})):d(e)}},1670:(e,n,t)=>{t.d(n,{Zo:()=>r,ah:()=>a});var s=t(7378);const o=s.createContext({});function a(e){const n=s.useContext(o);return s.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const c={};function r({components:e,children:n,disableParentContext:t}){let r;return r=t?"function"==typeof e?e({}):e||c:a(e),s.createElement(o.Provider,{value:r},n)}}}]);