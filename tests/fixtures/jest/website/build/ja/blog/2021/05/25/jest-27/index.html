<!doctype html>
<html lang="ja" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v0.0.0-5658">
<title data-rh="true">Jest 27: Jest の新しいデフォルト設定 - 2021 年版 ⏩ · Jest</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://jestjs.io/ja/img/opengraph.png"><meta data-rh="true" name="twitter:image" content="https://jestjs.io/ja/img/opengraph.png"><meta data-rh="true" property="og:url" content="https://jestjs.io/ja/blog/2021/05/25/jest-27"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" property="og:locale:alternate" content="es_ES"><meta data-rh="true" property="og:locale:alternate" content="fr"><meta data-rh="true" property="og:locale:alternate" content="pt_BR"><meta data-rh="true" property="og:locale:alternate" content="ro"><meta data-rh="true" property="og:locale:alternate" content="ru"><meta data-rh="true" property="og:locale:alternate" content="uk"><meta data-rh="true" property="og:locale:alternate" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Jest 27: Jest の新しいデフォルト設定 - 2021 年版 ⏩ · Jest"><meta data-rh="true" name="description" content="約1年前の Jest 26 のブログポスト内で発表したのは、2つのメジャーリリースでいくつかの破壊的変更を行った後、Jest 27 で新しいプロジェクトやスムーズな移行のために一部の設定をよりよいデフォルトに切り替えることでした。 これにより、Jest 28 のデフォルトの配布物からいくつかのパッケージを削除し、個別にインストール可能でプラガブルなモジュールとして公開する機会が得られます。 新しいデフォルト設定ではインストールサイズが小さくなるため、すべての人が恩恵を受けることができます。一方でこれらのパッケージが必要な人は、個別にインストールすることもできます。"><meta data-rh="true" property="og:description" content="約1年前の Jest 26 のブログポスト内で発表したのは、2つのメジャーリリースでいくつかの破壊的変更を行った後、Jest 27 で新しいプロジェクトやスムーズな移行のために一部の設定をよりよいデフォルトに切り替えることでした。 これにより、Jest 28 のデフォルトの配布物からいくつかのパッケージを削除し、個別にインストール可能でプラガブルなモジュールとして公開する機会が得られます。 新しいデフォルト設定ではインストールサイズが小さくなるため、すべての人が恩恵を受けることができます。一方でこれらのパッケージが必要な人は、個別にインストールすることもできます。"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2021-05-25T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/jeysal"><link data-rh="true" rel="icon" href="/ja/img/favicon/favicon.ico"><link data-rh="true" rel="canonical" href="https://jestjs.io/ja/blog/2021/05/25/jest-27"><link data-rh="true" rel="alternate" href="https://jestjs.io/blog/2021/05/25/jest-27" hreflang="en"><link data-rh="true" rel="alternate" href="https://jestjs.io/ja/blog/2021/05/25/jest-27" hreflang="ja"><link data-rh="true" rel="alternate" href="https://jestjs.io/es-ES/blog/2021/05/25/jest-27" hreflang="es-ES"><link data-rh="true" rel="alternate" href="https://jestjs.io/fr/blog/2021/05/25/jest-27" hreflang="fr"><link data-rh="true" rel="alternate" href="https://jestjs.io/pt-BR/blog/2021/05/25/jest-27" hreflang="pt-BR"><link data-rh="true" rel="alternate" href="https://jestjs.io/ro/blog/2021/05/25/jest-27" hreflang="ro"><link data-rh="true" rel="alternate" href="https://jestjs.io/ru/blog/2021/05/25/jest-27" hreflang="ru"><link data-rh="true" rel="alternate" href="https://jestjs.io/uk/blog/2021/05/25/jest-27" hreflang="uk"><link data-rh="true" rel="alternate" href="https://jestjs.io/zh-Hans/blog/2021/05/25/jest-27" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://jestjs.io/blog/2021/05/25/jest-27" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://HP439UUSOL-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/ja/blog/rss.xml" title="Jest RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ja/blog/atom.xml" title="Jest Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44373548-17"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-44373548-17",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Jest" href="/ja/opensearch.xml">

<link rel="icon" href="/ja/img/jest.png">
<link rel="manifest" href="/ja/manifest.json">
<meta name="theme-color" content="#FFF">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/ja/img/jest.png">
<link rel="mask-icon" href="/ja/img/jest.svg" color="#15c213">
<meta name="msapplication-TileImage" content="/ja/img/jest.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/ja/assets/css/styles.3a42a01f.css">
<script src="/ja/assets/js/runtime~main.f963ccf0.js" defer="defer"></script>
<script src="/ja/assets/js/main.cdd3f1bc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="メインコンテンツへスキップ"><a class="skipToContent_oPtH" href="#__docusaurus_skipToContent_fallback">メインコンテンツへスキップ</a></div><div class="announcementBar_zJRd" style="background-color:#20232a;color:#fff" role="banner"><div class="content_bSb_ announcementBarContent_t7IR">Support Ukraine 🇺🇦 <a target="_blank" rel="noopener noreferrer" href="https://opensource.facebook.com/support-ukraine"> Help Provide Humanitarian Aid to Ukraine</a>.</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ja/"><b class="navbar__title text--truncate">Jest</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/ja/docs/getting-started">29.6</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ja/docs/next/getting-started">Next</a></li><li><a class="dropdown__link" href="/ja/docs/getting-started">29.6</a></li><li><a class="dropdown__link" href="/ja/docs/29.5/getting-started">29.5</a></li><li><a class="dropdown__link" href="/ja/docs/29.4/getting-started">29.4</a></li><li><a href="https://jest-archive-august-2023.netlify.app/docs/29.3/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link">29.3<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://jest-archive-august-2023.netlify.app/docs/29.2/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link">29.2<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://jest-archive-august-2023.netlify.app/docs/29.1/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link">29.1<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://jest-archive-august-2023.netlify.app/docs/29.0/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link">29.0<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://jest-archive-august-2023.netlify.app/docs/28.x/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link">28.x<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://jest-archive-august-2023.netlify.app/docs/27.x/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link">27.x<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://jest-archive-august-2023.netlify.app/docs/26.x/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link">26.x<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://jest-archive-august-2023.netlify.app/docs/25.x/getting-started/" target="_blank" rel="noopener noreferrer" class="dropdown__link">25.x<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://archive.jestjs.io/docs/en/24.x/getting-started.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">24.x<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://archive.jestjs.io/docs/en/23.x/getting-started.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">23.x<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://archive.jestjs.io/docs/en/22.x/getting-started.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">22.x<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a class="dropdown__link" href="/ja/versions">All versions</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/ja/docs/getting-started">ドキュメント</a><a class="navbar__item navbar__link" href="/ja/docs/api">API</a><a class="navbar__item navbar__link" href="/ja/help">ヘルプ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ja/blog">ブログ</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_kvP7"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>日本語</a><ul class="dropdown__menu"><li><a href="/blog/2021/05/25/jest-27" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/ja/blog/2021/05/25/jest-27" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ja">日本語</a></li><li><a href="/es-ES/blog/2021/05/25/jest-27" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es-ES">Español</a></li><li><a href="/fr/blog/2021/05/25/jest-27" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">Français</a></li><li><a href="/pt-BR/blog/2021/05/25/jest-27" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt-BR">Português (Brasil)</a></li><li><a href="/ro/blog/2021/05/25/jest-27" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ro">Română</a></li><li><a href="/ru/blog/2021/05/25/jest-27" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ru">Русский</a></li><li><a href="/uk/blog/2021/05/25/jest-27" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="uk">Українська</a></li><li><a href="/zh-Hans/blog/2021/05/25/jest-27" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://github.com/jestjs/jest" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_ki11 colorModeToggle_Hewu"><button class="clean-btn toggleButton_MMFG toggleButtonDisabled_Uw7m" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_lgto"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_U96C"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_WqAV"><button type="button" class="DocSearch DocSearch-Button" aria-label="検索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">検索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_MB5r"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_CLW8 thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_DQfJ margin-bottom--md">最近の投稿</div><ul class="sidebarItemList_rvuc clean-list"><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/ja/blog/2022/08/25/jest-29">Jest 29: スナップショットフォーマットの変更</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/ja/blog/2022/05/11/jest-joins-openjs">Jest joins OpenJS Foundation</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/ja/blog/2022/04/25/jest-28">Jest 28: Shedding weight and improving compatibility 🫶</a></li><li class="sidebarItem__RMN"><a aria-current="page" class="sidebarItemLink_Ony9 sidebarItemLinkActive_MJ75" href="/ja/blog/2021/05/25/jest-27">Jest 27: Jest の新しいデフォルト設定 - 2021 年版 ⏩</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/ja/blog/2021/03/09/jest-website-upgrade">Jest Website Upgrade</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="約1年前の Jest 26 のブログポスト内で発表したのは、2つのメジャーリリースでいくつかの破壊的変更を行った後、Jest 27 で新しいプロジェクトやスムーズな移行のために一部の設定をよりよいデフォルトに切り替えることでした。 これにより、Jest 28 のデフォルトの配布物からいくつかのパッケージを削除し、個別にインストール可能でプラガブルなモジュールとして公開する機会が得られます。 新しいデフォルト設定ではインストールサイズが小さくなるため、すべての人が恩恵を受けることができます。一方でこれらのパッケージが必要な人は、個別にインストールすることもできます。"><header><h1 class="title_Kdtz" itemprop="headline">Jest 27: Jest の新しいデフォルト設定 - 2021 年版 ⏩</h1><div class="container_iZB2 margin-vert--md"><time datetime="2021-05-25T00:00:00.000Z" itemprop="datePublished">2021年5月25日</time> · <!-- -->読むのにかかる時間 1分</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_v1VX"><div class="avatar margin-bottom--sm"><a href="https://github.com/jeysal" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/16069751" alt="Tim Seckinger" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/jeysal" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Tim Seckinger</span></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>約1年前の <a href="/ja/blog/2020/05/05/jest-26">Jest 26 のブログポスト</a>内で発表したのは、2つのメジャーリリースでいくつかの破壊的変更を行った後、Jest 27 で新しいプロジェクトやスムーズな移行のために一部の設定をよりよいデフォルトに切り替えることでした。 これにより、Jest 28 のデフォルトの配布物からいくつかのパッケージを削除し、個別にインストール可能でプラガブルなモジュールとして公開する機会が得られます。 新しいデフォルト設定ではインストールサイズが小さくなるため、すべての人が恩恵を受けることができます。一方でこれらのパッケージが必要な人は、個別にインストールすることもできます。</p>
<p>Jest 27では、Jestの高速性、効率性、将来性を維持するためにmバージョン15に付属していた <a href="/ja/blog/2016/09/01/jest-15">New Defaults for Jest</a> 以来の大きなデフォルト設定の変更が行われました。 この記事では、これらのデフォルトの変更やその他の注目すべき変更点について説明しますが、その前に、エキサイティングな新機能についてご紹介します!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="機能アップデート">機能アップデート<a href="#機能アップデート" class="hash-link" aria-label="Direct link to 機能アップデート" title="Direct link to 機能アップデート">​</a></h2>
<p>Firstly, the interactive mode you may know from reviewing and updating failed snapshots can now also be used to <strong>step through failed tests</strong> one at a time. Credit goes to first-time contributor <a href="https://github.com/NullDivision" target="_blank" rel="noopener noreferrer">@NullDivision</a> for <a href="https://github.com/jestjs/jest/pull/10858" target="_blank" rel="noopener noreferrer">implementing</a> this feature!</p>
<p><img loading="lazy" alt="Interactive failed test run" src="/ja/assets/images/27-interactive-failures-e22e3b31b285188ed65f6432cb21df30.png" width="2416" height="1289" class="img_SS3x"></p>
<p>Speaking of snapshots, one of the more exciting features we&#x27;ve shipped in recent years are Inline Snapshots, which <a href="https://github.com/jestjs/jest/pull/6380" target="_blank" rel="noopener noreferrer">landed</a> in a minor release of Jest 23 almost three years ago. However, they came with the restriction that projects wanting to utilize them must be using <a href="https://prettier.io/" target="_blank" rel="noopener noreferrer">Prettier</a> to format their code, because that&#x27;s what Jest would use to make sure the file it writes the snapshots into remains properly formatted.<br>
<!-- -->And so for most of these years, we&#x27;ve had a <a href="https://github.com/jestjs/jest/pull/7792" target="_blank" rel="noopener noreferrer">pull request</a> in the pipeline to eliminate this restriction and allow using <strong>Inline Snapshots without Prettier</strong>. It has amassed well above a hundred comments, not even taking into account PRs split out from it and landed first, and even changed owner once after the initial submission by another first-time contributor, <a href="https://github.com/mmkal" target="_blank" rel="noopener noreferrer">@mmkal</a> under the hilarious working title &#x27;Uglier Inline Snapshots&#x27;. With the stellar rise of Prettier in recent times, this improvement is now maybe less needed than back in 2018, but still, we know that feeling of getting into a project that does not use Prettier, and suddenly not being able to use inline snapshots anymore. Nevermore!</p>
<p>The main reason why it took us so long to land this was, somewhat surprisingly, an out of memory error on our build pipeline. It turns out that the dependencies we load for each test file to perform the parsing, snapshot insertion, and printing do incur a significant time and memory overhead.<br>
<!-- -->So with some <a href="https://github.com/jestjs/jest/issues/9898" target="_blank" rel="noopener noreferrer">tricks</a>, we&#x27;ve <strong>speed up the initialization per test file</strong> by roughly 70% compared to Jest 26. Note that you will almost certainly not see this big of a performance improvement on your project—you would need a lot of test files that each run very quickly to best notice this, and the overhead when using a <a href="/ja/docs/configuration#testenvironment-string">JSDOM environment</a> dwarfs any such improvement.</p>
<p>In other news, the <a href="https://github.com/jestjs/jest/issues/9430" target="_blank" rel="noopener noreferrer">native ESM support</a> is progressing, but some major complexities, for instance around mocking, are still ahead of us, and we continue to observe the migration to ESM as a huge ecosystem effort, where Node and a lot of crucial tools and packages all have to rely on each other to deliver an overall compelling experience.<br>
<!-- -->ESM support <a href="https://github.com/jestjs/jest/issues/11167" target="_blank" rel="noopener noreferrer">for plugging modules into Jest</a> is more advanced—custom runners, reporters, watch plugins, and many other modules can already be loaded as ES modules.</p>
<p>We&#x27;ve also merged <a href="https://github.com/jestjs/jest/pull/9351" target="_blank" rel="noopener noreferrer">a PR</a> to be able to deal with test files symlinked into the test directory, a feature much wanted by users of <a href="https://bazel.build/" target="_blank" rel="noopener noreferrer">Bazel</a>.</p>
<p><a href="https://github.com/jestjs/jest/issues/9504" target="_blank" rel="noopener noreferrer">Another PR</a> enabled <a href="/ja/docs/configuration#transform-objectstring-pathtotransformer--pathtotransformer-object"><code>transform</code>s</a> to be asynchronous, a requirement to support transpilation through tools such as <a href="https://esbuild.github.io/" target="_blank" rel="noopener noreferrer">esbuild</a>, <a href="https://www.snowpack.dev/" target="_blank" rel="noopener noreferrer">Snowpack</a>, and <a href="https://vitejs.dev/" target="_blank" rel="noopener noreferrer">Vite</a> effectively.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="デフォルト設定の切り替え">デフォルト設定の切り替え<a href="#デフォルト設定の切り替え" class="hash-link" aria-label="Direct link to デフォルト設定の切り替え" title="Direct link to デフォルト設定の切り替え">​</a></h2>
<p>Up until now, if you were using Jest in its default configuration, you were—perhaps unknowingly—running some code forked many years ago from the test runner <a href="https://jasmine.github.io/2.0/introduction" target="_blank" rel="noopener noreferrer">Jasmine 2.0</a> that provides test framework functions such as <code>describe</code>, <code>it</code>, and <code>beforeEach</code>. In 2017, <a href="https://github.com/aaronabramov" target="_blank" rel="noopener noreferrer">Aaron Abramov</a> <a href="https://github.com/jestjs/jest/pull/3668" target="_blank" rel="noopener noreferrer">initially wrote</a> a <strong>replacement for the Jasmine code</strong> called <code>jest-circus</code>, meant to improve error messages, maintainability, and extensibility.<br>
<!-- -->After years of large-scale use at Facebook and of course in Jest itself, as well as recent adoption in <code>create-react-app</code>, we are now confident that <code>jest-circus</code> is highly compatible with <code>jest-jasmine2</code> and should work in most environments with little to no migration work. There may be minor differences in execution order and strictness, but we expect no major upgrade difficulties other than for code relying on Jasmine-specific APIs such as <code>jasmine.getEnv()</code>. If you rely extensively on such APIs, you can opt back in to the Jasmine-based test runner by <a href="/ja/docs/configuration#testrunner-string">configuring</a> <code>&quot;testRunner&quot;: &quot;jest-jasmine2&quot;</code>.</p>
<p>Running tests in a <a href="/ja/docs/configuration#testenvironment-string">JSDOM environment</a> incurs a significant performance overhead. Because this was the default behavior of Jest unless otherwise configured up until now, users who are writing Node apps, for example, may not even know they are given an expensive DOM environment that they do not even need.<br>
<!-- -->For this reason, we are <strong>changing the default test environment</strong> from <code>&quot;jsdom&quot;</code> to <code>&quot;node&quot;</code>. If you are affected by this change because you use DOM APIs and do not have the test environment explicitly configured, you should be receiving an error when e.g. <code>document</code> is accessed, and you can configure <code>&quot;testEnvironment&quot;: &quot;jsdom&quot;</code> or use <a href="/ja/docs/configuration#testenvironment-string">per-file environment configuration</a> to resolve this.<br>
<!-- -->For mixed projects where some tests require a DOM environment but others don&#x27;t, we recommend using the fast <code>&quot;node&quot;</code> environment by default and declaring exactly those tests that need the DOM using <a href="/ja/docs/configuration#testenvironment-string">docblocks</a>.<br>
<!-- -->In the next major, we plan to also eliminate <code>jest-jasmine2</code> and <code>jest-environment-jsdom</code> from the Jest dependency tree and require them to be installed explicitly, so that many users can profit from a smaller install size with less clutter that they don&#x27;t need.</p>
<p>Another default that we are changing affects Fake Timers aka <a href="/ja/docs/timer-mocks">Timer Mocks</a>. We introduced an opt-in &quot;modern&quot; implementation of Fake Timers in Jest 26 accessed transparently through the same API, but with much more comprehensive mocking, such as for <code>Date</code> and <code>queueMicrotask</code>.<br>
<!-- -->This <strong>modern fake timers implementation will now be the default</strong>. If you are among the unlucky few who are affected by the subtle implementation differences too heavily to migrate, you can get back the old implementation using <code>jest.useFakeTimers(&quot;legacy&quot;)</code> or, if you are enabling fake timers globally via <a href="/ja/docs/configuration#timers-string">configuration</a>, <code>&quot;timers&quot;: &quot;legacy&quot;</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="破壊的変更を伴って追加された機能">破壊的変更を伴って追加された機能<a href="#破壊的変更を伴って追加された機能" class="hash-link" aria-label="Direct link to 破壊的変更を伴って追加された機能" title="Direct link to 破壊的変更を伴って追加された機能">​</a></h2>
<p>We introduced a few more small breaking changes to help you avoid mistakes by disallowing some things that can easily happen unintentionally:</p>
<ul>
<li>The same <code>done</code> test callback may not be called more than once,</li>
<li>calling <code>done</code> and returning a Promise may not be combined,</li>
<li>a <code>describe</code> block must not return anything,</li>
</ul>
<p>and we <a href="https://github.com/jestjs/jest/pull/10512" target="_blank" rel="noopener noreferrer">made some TypeScript types stricter</a>.</p>
<p>Modules used in the following configuration options are now transformed like the rest of your code, which may be breaking if you relied on them being loaded as-is:</p>
<ul>
<li><code>testEnvironment</code></li>
<li><code>runner</code></li>
<li><code>testRunner</code></li>
<li><code>snapshotResolver</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="その他の破壊的変更">その他の破壊的変更<a href="#その他の破壊的変更" class="hash-link" aria-label="Direct link to その他の破壊的変更" title="Direct link to その他の破壊的変更">​</a></h2>
<p>長い間廃止予定となっていた以下の関数を削除しました。</p>
<ul>
<li><code>jest.addMatchers</code> (代わりに <code>expect.extend</code> を使用してください)</li>
<li><code>jest.resetModuleRegistry</code> (代わりに <code>jest.resetModule</code> を使用してください)</li>
<li><code>jest.runTimersToTime</code> (代わりに <code>jest.advanceTimersByTime</code> を使用してください)</li>
</ul>
<p>A lot of Jest&#x27;s packages have been migrated to use ESM-style exports (although they are still shipped as CommonJS), so if you consume e.g. <code>pretty-format</code> directly, you may need to adjust your import to a <code>default</code> import.</p>
<p>We dropped support for Node 13—but Jest always supports the <em>Current</em> and all <em>LTS</em> <a href="https://nodejs.org/en/about/releases/" target="_blank" rel="noopener noreferrer">Node versions</a>, and Jest 27 continues to support Node 10, which only recently became unmaintained.</p>
<p>As always, the full changelog and list of breaking changes can be <a href="https://github.com/jestjs/jest/blob/main/CHANGELOG.md#2700" target="_blank" rel="noopener noreferrer">viewed here</a>.</p>
<p>Finally, we&#x27;d like to thank the community for once again awarding Jest a sky-high satisfaction rating of 96% in the <a href="https://2020.stateofjs.com/en-US/technologies/testing/" target="_blank" rel="noopener noreferrer">State of JS 2020</a> survey! Stay safe everyone, and we hope you continue to enjoy using Jest in the years and versions to come! 🃏</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_JgJa"><div class="col margin-top--sm"><a href="https://github.com/jestjs/jest/tree/main/website/blog/2021-05-25-jest-27.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_bHB7" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ブログ投稿ページのナビゲーション"><a class="pagination-nav__link pagination-nav__link--prev" href="/ja/blog/2022/04/25/jest-28"><div class="pagination-nav__sublabel">次の記事</div><div class="pagination-nav__label">Jest 28: Shedding weight and improving compatibility 🫶</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ja/blog/2021/03/09/jest-website-upgrade"><div class="pagination-nav__sublabel">前の記事</div><div class="pagination-nav__label">Jest Website Upgrade</div></a></nav></main><div class="col col--2"><div class="tableOfContents_XG6w thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#機能アップデート" class="table-of-contents__link toc-highlight">機能アップデート</a></li><li><a href="#デフォルト設定の切り替え" class="table-of-contents__link toc-highlight">デフォルト設定の切り替え</a></li><li><a href="#破壊的変更を伴って追加された機能" class="table-of-contents__link toc-highlight">破壊的変更を伴って追加された機能</a></li><li><a href="#その他の破壊的変更" class="table-of-contents__link toc-highlight">その他の破壊的変更</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ドキュメント</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ja/docs/getting-started">はじめましょう</a></li><li class="footer__item"><a class="footer__link-item" href="/ja/docs/snapshot-testing">ガイド</a></li><li class="footer__item"><a class="footer__link-item" href="/ja/docs/api">APIリファレンス</a></li></ul></div><div class="col footer__col"><div class="footer__title">コミュニティ</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.reactiflux.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reactiflux<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/jestjs_" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">その他</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ja/blog">ブログ</a></li><li class="footer__item"><a href="https://github.com/jestjs/jest" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/jestjs_" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">法的事項</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">プライバシー<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">利用規約<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" rel="noopener noreferrer" class="footerLogoLink_tutC"><img src="/ja/img/oss_logo.png" alt="Facebook Open Source Logo" class="footer__logo themedComponent_siVc themedComponent--light_hHel"><img src="/ja/img/oss_logo.png" alt="Facebook Open Source Logo" class="footer__logo themedComponent_siVc themedComponent--dark_yETr"></a></div><div class="footer__copyright">Copyright © 2023 Meta Platforms, Inc. and affiliates. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>